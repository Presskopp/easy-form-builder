let stepsCount,exportView_emsFormBuilder=[],sendBack_emsFormBuilder_pub=[],sessionPub_emsFormBuilder="reciveFromClient",stepNames_emsFormBuilder=["t","",""],currentTab_emsFormBuilder=0,multiSelectElemnets_emsFormBuilder=[],formNameEfb="",files_emsFormBuilder=[],addons_emsFormBuilder="",recaptcha_emsFormBuilder="",poster_emsFormBuilder="";const fileSizeLimite_emsFormBuilder=83e5;let select_options_emsFormBuilder=[],form_type_emsFormBuilder="form",valueJson_ws=[],motus_efb={},g_timeout_efb=100,price_efb="";function fun_render_view_efb(e,t){var s=new URL(window.location);history.replaceState("EFBstep-1",null,s),exportView_emsFormBuilder=[],valueJson_ws=JSON.parse(e.replace(/[\\]/g,"")),valueJson_ws[0].email="",valj_efb=valueJson_ws,fun_gets_url_efb(),formNameEfb=valj_efb[0].formName,state_efb="run",previewFormEfb("run"),valj_efb[0].hasOwnProperty("logic")&&1==valj_efb[0].logic&&(stack_steps_efb.push(1),logic_ui_forms_efb()),"payment"==form_type_emsFormBuilder&&setTimeout((()=>{fun_total_pay_efb()}),2*valj_efb.length)}function createStepsOfPublic(){for(let e of document.querySelectorAll(".emsFormBuilder_v")){let t="";if("submit"!=e.type){switch(e.type){case"file":const t=valueJson_ws.find((t=>t.id_===e.dataset.vid));(t.hasOwnProperty("disabled")&&1!=t.disabled||0==t.hasOwnProperty("disabled"))&&(t.hasOwnProperty("hidden")&&1==t.hidden||0==t.hasOwnProperty("hidden"))&&files_emsFormBuilder.push({id_:t.id_,value:"@file@",state:0,url:"",type:"file",name:t.name,session:sessionPub_emsFormBuilder});break;case"hidden":break;case"checkbox":case"radio":document.getElementById(e.id).addEventListener("change",(t=>{e.dataset.tag&&0!=e.dataset.tag.includes("chl")||e.classList.contains("payefb")&&valj_efb[0].type}));break}e.addEventListener("change",(t=>{handle_change_event_efb(e)})),"text"==e.type&&e.classList.contains("hijri-picker")&&$("#"+e.id).on("dp.change",(function(t){if(!t.date)return void $("#selected-date").html("");t.date;handle_change_event_efb(e)}))}else"checkbox"==e.type&&"payment"==valj_efb[0].type&&e.classList.contains("payefb")?(fun_sendBack_emsFormBuilder(o[0]),fun_total_pay_efb()):"submit"==e.type&&e.addEventListener("click",(s=>{const a=e.dataset.vid,n=valueJson_ws.find((e=>e.id_===a));let l=[{id_:a,name:n.name,id_ob:e.id,amount:n.amount,type:e.type,value:e.value,session:sessionPub_emsFormBuilder}];if("payment"==valj_efb[0].type&&e.classList.contains("payefb")){let s=valueJson_ws.find((t=>t.id_===e.id));const a=price_efb.length>0?{price:t}:{price:s.price};Object.assign(l[0],a),fun_sendBack_emsFormBuilder(l[0]),fun_total_pay_efb()}else fun_sendBack_emsFormBuilder(l[0])}))}}function handle_change_event_efb(e){validate_len=()=>{let t=document.getElementById("body_efb").offsetWidth;let r=e.hasAttribute("minlength")?e.minLength:"number"!=e.type?2:0;if(s.length<r&&"number"!=e.type){n=!1,e.className=colorBorderChangerEfb(e.className,"border-danger"),l=document.getElementById(`${e.id}-message`);let s=ajax_object_efm.text.mmplen.replace("NN",r),o=Number(t)<380&&0==window.matchMedia("(max-width: 480px)").matches?`<div class="efb fs-5 nmsgefb bi-exclamation-diamond-fill" onClick="alert_message_efb('${s}','',10,'danger')"></div>`:s;l&&(Number(t)<525&&0==window.matchMedia("(max-width: 480px)").matches&&l.classList.add("unpx"),l.innerHTML=o,l.classList.add("show"));const i=sendBack_emsFormBuilder_pub.findIndex((e=>e.id_==a));return-1!=i&&sendBack_emsFormBuilder_pub.splice(i,1),0}if(s<r&&"number"==e.type){n=!1,e.className=colorBorderChangerEfb(e.className,"border-danger"),l=document.getElementById(`${e.id}-message`);let s=ajax_object_efm.text.mcplen.replace("NN",r),o=Number(t)<380&&0==window.matchMedia("(max-width: 480px)").matches?`<div class="efb fs-5 nmsgefb bi-exclamation-diamond-fill" onClick="alert_message_efb('${s}','',10,'danger')"></div>`:s;l&&(Number(t)<525&&0==window.matchMedia("(max-width: 480px)").matches&&l.classList.add("unpx"),l.innerHTML=o,l.classList.add("show"));const i=sendBack_emsFormBuilder_pub.findIndex((e=>e.id_==a));return-1!=i&&sendBack_emsFormBuilder_pub.splice(i,1),0}if(r=e.hasAttribute("maxlength")?e.maxLength:0,0==r)return 1;if(s.length>r&&"number"!=e.type){n=!1,e.className=colorBorderChangerEfb(e.className,"border-danger"),l=document.getElementById(`${e.id}-message`);let s=ajax_object_efm.text.mmxplen.replace("NN",r),o=Number(t)<380&&0==window.matchMedia("(max-width: 480px)").matches?`<div class="efb fs-5 nmsgefb bi-exclamation-diamond-fill" onClick="alert_message_efb('${s}','',10,'danger')"></div>`:s;l&&(Number(t)<525&&0==window.matchMedia("(max-width: 480px)").matches&&l.classList.add("unpx"),l.innerHTML=o,l.classList.add("show"));const i=sendBack_emsFormBuilder_pub.findIndex((e=>e.id_==a));return-1!=i&&sendBack_emsFormBuilder_pub.splice(i,1),0}if(s>r&&"number"==e.type){n=!1,e.className=colorBorderChangerEfb(e.className,"border-danger"),l=document.getElementById(`${e.id}-message`);let s=ajax_object_efm.text.mxcplen.replace("NN",r),o=Number(t)<380&&0==window.matchMedia("(max-width: 480px)").matches?`<div class="efb fs-5 nmsgefb bi-exclamation-diamond-fill" onClick="alert_message_efb('${s}','',10,'danger')"></div>`:s;l&&(Number(t)<525&&0==window.matchMedia("(max-width: 480px)").matches&&l.classList.add("unpx"),l.innerHTML=o,l.classList.add("show"));const i=sendBack_emsFormBuilder_pub.findIndex((e=>e.id_==a));return-1!=i&&sendBack_emsFormBuilder_pub.splice(i,1),0}return 1};let t=valueJson_ws.find((t=>t.id_===e.dataset.vid)),s="";const a=e.dataset.vid;let n,l;if(t||0!=e.id.includes("chl")&&(t=sendBack_emsFormBuilder_pub.find((t=>t.id_ob===e.dataset.id))),valj_efb[0].hasOwnProperty("booking")&&1==Number(valj_efb[0].booking)){const t=fun_booking_avilable(e);if(0==t[0])return void alert_message_efb(t[1],"",150,"danger")}switch(e.type){case"text":case"color":case"number":case"date":case"textarea":const r="textarea"==e.type;if(s=sanitize_text_efb(e.value,r),1==e.classList.contains("intlPhone"))return;if(0==validate_len())return;-1!=s.search('"')&&(e.value=s.replaceAll('"',""),noti_message_efb("Don't use forbidden Character like: \"","danger",`step-${current_s_efb}-efb-msg`)),e.className=colorBorderChangerEfb(e.className,"border-success"),l=document.getElementById(`${e.id}-message`),l&&l.classList.remove("show");break;case"url":null==e.value.match(/^https?:\/\/(?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b(?:[-a-zA-Z0-9()@:%_\+.~#?&\/=]*)$/g)?(valid=!1,l=document.getElementById(`${e.id}-message`),e.className=colorBorderChangerEfb(e.className,"border-danger"),l.innerHTML=ajax_object_efm.text.enterValidURL,l.classList.contains("show")&&l.classList.add("show")):(valid=!0,s=e.value,l=document.getElementById(`${e.id}-message`),l.classList.remove("show"),l.innerHTML="",e.className=colorBorderChangerEfb(e.className,"border-success"));break;case"checkbox":case"radio":if(s=sanitize_text_efb(e.value),"switch"==t.type&&(s=1==e.checked?ajax_object_efm.text.on:ajax_object_efm.text.off),l=document.getElementById(`${t.id_}_-message`),e.value.length>1||1==e.checked?(l.classList.remove("show"),l.innerHTML=""):(l.innerHTML=ajax_object_efm.text.enterTheValueThisField,l.classList.contains("show")&&l.classList.add("show")),0==e.checked&&"checkbox"==e.type){const s=sendBack_emsFormBuilder_pub.findIndex((t=>t.id_ob==e.id));if(-1!=s)return sendBack_emsFormBuilder_pub.splice(s,1),"payCheckbox"==t.type&&fun_total_pay_efb(),void(valj_efb[0].hasOwnProperty("logic")&&valj_efb[0].logic&&fun_statement_logic_efb(e.id,e.type))}const o=valj_efb.findIndex((t=>t.id_==e.name));if(-1!=o&&0!=valj_efb[o].type.includes("chl")&&1==e.checked){if("checkbox"==e.type){const t=e.id+"_chl";document.getElementById(t).disabled=!1}}else if(-1!=o&&0!=valj_efb[o].type.includes("chl")&&0==e.checked){const t=e.id+"_chl";document.getElementById(t).disabled=!0,document.getElementById(t).value=""}valj_efb[0].hasOwnProperty("logic")&&valj_efb[0].logic&&fun_statement_logic_efb(e.id,e.type);break;case"select-one":case"select":if(s=sanitize_text_efb(e.value),l=document.getElementById(`${t.id_}_-message`),l.classList.remove("show"),l.innerHTML="",e.className=colorBorderChangerEfb(e.className,"border-success"),"payment"==valj_efb[0].type&&e.classList.contains("payefb")){let t=e.options[e.selectedIndex].id;t=valueJson_ws.find((s=>s.id_==t&&s.value==e.value)),"string"==typeof t.price&&(price_efb=t.price)}valj_efb[0].hasOwnProperty("logic")&&valj_efb[0].logic&&fun_statement_logic_efb(e.dataset.vid,e.type);break;case"range":s=sanitize_text_efb(e.value),l=document.getElementById(`${t.id_}_-message`),l.classList.remove("show"),l.innerHTML="";break;case"email":n=valid_email_emsFormBuilder(e),s=1==n?sanitize_text_efb(e.value):"";break;case"tel":n=valid_phone_emsFormBuilder(e),s=1==n?sanitize_text_efb(e.value):"";break;case"password":n=valid_password_emsFormBuilder(e),s=1==n?sanitize_text_efb(e.value):"";break;case"select-multiple":e.name;if(1==e.classList.contains("multiple-emsFormBuilder"))for(let t=0;t<e.children.length;t++)s+=e.children[t].value+",";break;case"file":valid_file_emsFormBuilder(a,"msg");break;case"hidden":s=sanitize_text_efb(e.value);break;case void 0:let i=!1;for(let t of exportView_emsFormBuilder)if(t.id_==e.id){i=!0;break}if(1==i){t=valueJson_ws.find((t=>t.id_===e.id));for(let e of select_options_emsFormBuilder)s+=e+","}break;default:l=document.getElementById(`${t.id_}_-message`),t||(l.classList.remove("show"),l.innerHTML="");break}if(""!=s||s.length>1){const n=t.type,l="paySelect"!=t.type?e.id:e.options[e.selectedIndex].id;let r=[{id_:a,name:t.name,id_ob:l,amount:t.amount,type:n,value:s,session:sessionPub_emsFormBuilder}];if("payment"==valj_efb[0].type&&e.classList.contains("payefb")){let t=valueJson_ws.find((t=>t.id_===e.id));const s=price_efb.length>0?{price:price}:{price:t.price};Object.assign(r[0],s),fun_sendBack_emsFormBuilder(r[0]),fun_total_pay_efb()}else if(n.includes("chl")){const s=e.id.includes("_chl"),a=s?document.getElementById(e.id).value:"";0==s?Object.assign(r[0],{qty:a}):(e.classList.remove("bg-danger"),t.qty=fun_text_forbiden_convert_efb(a),r[0]=""),fun_sendBack_emsFormBuilder(r[0])}else r[0].type,fun_sendBack_emsFormBuilder(r[0])}}function fun_sendBack_emsFormBuilder(e){if("string"!=typeof e){if(remove_ttmsg_efb(e.id_),e.hasOwnProperty("value")&&"number"!=typeof e.value&&"object"!=typeof e.value?e.value=fun_text_forbiden_convert_efb(e.value):e.hasOwnProperty("value")&&"object"==typeof e.value&&"maps"==e.type&&(e.value=e.value),sendBack_emsFormBuilder_pub.length>0){let t=sendBack_emsFormBuilder_pub.findIndex((t=>t.id_===e.id_));-1==t||"switch"==e.type||"checkbox"!=sendBack_emsFormBuilder_pub[t].type&&"payCheckbox"!=sendBack_emsFormBuilder_pub[t].type&&"multiselect"!=sendBack_emsFormBuilder_pub[t].type&&"payMultiselect"!=sendBack_emsFormBuilder_pub[t].type&&"chlCheckBox"!=sendBack_emsFormBuilder_pub[t].type?-1!=t&&"@file@"==e.value?sendBack_emsFormBuilder_pub[t]=e:"r_matrix"==e.type?(t=sendBack_emsFormBuilder_pub.findIndex((t=>t.id_ob===e.id_ob)),-1==t?sendBack_emsFormBuilder_pub.push(e):sendBack_emsFormBuilder_pub[t]=e):-1==t?sendBack_emsFormBuilder_pub.push(e):"string"!=typeof e.price?sendBack_emsFormBuilder_pub[t].value=e.value:(sendBack_emsFormBuilder_pub[t].value=e.value,sendBack_emsFormBuilder_pub[t].price=e.price):(t=sendBack_emsFormBuilder_pub.findIndex((t=>t.id_===e.id_&&t.value==e.value)),-1==t?sendBack_emsFormBuilder_pub.push(e):sendBack_emsFormBuilder_pub.splice(t,1))}else sendBack_emsFormBuilder_pub.push(e);localStorage.setItem("sendback",JSON.stringify(sendBack_emsFormBuilder_pub)),localStorage.setItem("formId",efb_var.id)}}function alarm_emsFormBuilder(e){return`<div class="efb alert alert-warning alert-dismissible fade show " role="alert" id="alarm_emsFormBuilder">\n      <div><i class="efb nmsgefb bi-exclamation-triangle-fill text-center"></i></div>\n      <strong>${ajax_object_efm.text.alert} </strong>${e}\n    </div>`}function endMessage_emsFormBuilder_view(){const e=valj_efb[0].hasOwnProperty("logic")&&1==valj_efb[0].logic?"logic_fun_prev_send()":"fun_prev_send()",t=currentTab_emsFormBuilder+1;let s=[];for(let e=1;e<=t;e++)-1==sendBack_emsFormBuilder_pub.findIndex((t=>t.step==e))&&s.push(e);const a=valj_efb[0].hasOwnProperty("corner")?valj_efb[0].corner:"efb-square";let n=0,l=0;for(let e of exportView_emsFormBuilder)if(1==e.required){const t=e.id_;n+=1,-1==sendBack_emsFormBuilder_pub.findIndex((e=>e.id_==t))&&(l+=1)}if(document.getElementById("body_efb")&&document.getElementById("body_efb").scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),n!=l&&sendBack_emsFormBuilder_pub.length<1){currentTab_emsFormBuilder=0,document.getElementById("efb-final-step").innerHTML=`<h1 class='efb emsFormBuilder'><i class="efb nmsgefb bi-exclamation-triangle-fill text-center"></i></h1><h3>${ajax_object_efm.text.error}</h3> <span class="efb mb-2">${ajax_object_efm.text.pleaseMakeSureAllFields}</span>\n    <div class="efb m-1"> <button id="prev_efb_send" type="button" class="efb btn efb ${valj_efb[0].button_color}   ${a}   ${valj_efb[0].el_height}  p-2 text-center  btn-lg " onClick="${e}"><i class="efb  ${valj_efb[0].button_Previous_icon} ${valj_efb[0].button_Previous_icon} ${valj_efb[0].icon_color} mx-2 fs-6 " id="button_group_Previous_icon"></i><span id="button_group_Previous_button_text" class="efb  ${valj_efb[0].el_text_color} ">${valj_efb[0].button_Previous_text}</span></button></div></div>`}else{let t=0;for(let s of files_emsFormBuilder)if(files_emsFormBuilder.length>0&&1==s.state)t+=1;else if(files_emsFormBuilder.length>0&&3==s.state)return t=-100,void(document.getElementById("efb-final-step").innerHTML=`<h3 class='efb emsFormBuilder'><i class="efb nmsgefb bi-exclamation-triangle-fill text-center"></i></h1><h3 class="efb font-weight-bold">File Error</h3> <span class="efb font-weight-bold">${ajax_object_efm.text.youNotPermissionUploadFile}</br>${s.url}</span>\n         <div class="efb m-1"> <button id="prev_efb_send" type="button" class="efb btn efb ${valj_efb[0].button_color}   ${a}   ${valj_efb[0].el_height}  p-2 text-center  btn-lg  " onClick="${e}"><i class="efb  ${valj_efb[0].button_Previous_icon} ${valj_efb[0].button_Previous_icon} ${valj_efb[0].icon_color} mx-2 fs-6 " id="button_group_Previous_icon"></i><span id="button_group_Previous_button_text" class="efb  ${valj_efb[0].el_text_color} ">${valj_efb[0].button_Previous_text}</span></button></div></div>`);if(0==t){if(files_emsFormBuilder.length>0)for(const e of files_emsFormBuilder)-1==sendBack_emsFormBuilder_pub.findIndex((t=>t.id_==e.id_))&&(sendBack_emsFormBuilder_pub.push(e),localStorage.setItem("sendback",JSON.stringify(sendBack_emsFormBuilder_pub)));1==validation_before_send_emsFormBuilder()&&actionSendData_emsFormBuilder()}else{const t=setInterval((function(){let s=0;for(let t of files_emsFormBuilder)if(files_emsFormBuilder.length>0&&1==t.state)s+=1;else if(files_emsFormBuilder.length>0&&3==t.state)return s=-100,void(document.getElementById("efb-final-step").innerHTML=`<h3 class='efb emsFormBuilder'><i class="efb nmsgefb bi-exclamation-triangle-fill text-center"></i></h1><h3 class="efb fs-4">File Error</h3> <span class="efb fs-6">${ajax_object_efm.text.youNotPermissionUploadFile}</br>${t.url}</span>\n               <div class="efb m-1"> <button id="prev_efb_send" type="button" class="efb btn efb ${valj_efb[0].button_color}   ${a}   ${valj_efb[0].el_height}  p-2 text-center  btn-lg  " onClick="${e}"><i class="efb  ${valj_efb[0].button_Previous_icon} ${valj_efb[0].button_Previous_icon} ${valj_efb[0].icon_color} mx-2 fs-6 " id="button_group_Previous_icon"></i><span id="button_group_Previous_button_text" class="efb  ${valj_efb[0].el_text_color} ">${valj_efb[0].button_Previous_text}</span></button></div></div>`);if(0==s){for(const e of files_emsFormBuilder)sendBack_emsFormBuilder_pub.push(e),localStorage.setItem("sendback",JSON.stringify(sendBack_emsFormBuilder_pub));1==validation_before_send_emsFormBuilder()&&actionSendData_emsFormBuilder(),clearInterval(t)}}),1500)}}}function actionSendData_emsFormBuilder(){if("userIsLogin"==ajax_object_efm.type)return 0;if("login"!=form_type_emsFormBuilder&&localStorage.setItem("sendback",JSON.stringify(sendBack_emsFormBuilder_pub)),recaptcha_emsFormBuilder=valueJson_ws.length>1&&1==valueJson_ws[0].hasOwnProperty("captcha")&&1==valueJson_ws[0].captcha&&"object"==typeof grecaptcha?grecaptcha.getResponse():"",!navigator.onLine)return void response_fill_form_efb({success:!1,data:{success:!1,m:ajax_object_efm.text.offlineMSend}});form_type_emsFormBuilder=typeof valj_efb.length>2?valj_efb[0].type:form_type_emsFormBuilder;let e={action:"get_form_Emsfb",value:JSON.stringify(sendBack_emsFormBuilder_pub),name:formNameEfb,id:efb_var.id,valid:recaptcha_emsFormBuilder,type:form_type_emsFormBuilder,url:location.href.split("?")[0],sid:efb_var.sid};valj_efb.length>0&&valj_efb[0].hasOwnProperty("type")&&"payment"==valj_efb[0].type&&("persiaPay"==valj_efb[0].getway?e={action:"get_form_Emsfb",value:JSON.stringify(sendBack_emsFormBuilder_pub),name:formNameEfb,payid:sessionStorage.getItem("payId"),id:sessionStorage.getItem("id"),valid:recaptcha_emsFormBuilder,type:form_type_emsFormBuilder,payment:"persiaPay",auth:get_authority_efb,url:location.href.split("?")[0],sid:efb_var.sid}:"stripe"==valj_efb[0].getway&&(e={action:"get_form_Emsfb",value:JSON.stringify(sendBack_emsFormBuilder_pub),name:formNameEfb,id:efb_var.id,payid:efb_var.payId,valid:recaptcha_emsFormBuilder,type:form_type_emsFormBuilder,payment:"stripe",url:location.href.split("?")[0],sid:efb_var.sid})),post_api_forms_efb(e)}function valid_email_emsFormBuilder(e){let t=document.getElementById("body_efb").offsetWidth;const s=Number(t)<380&&0==window.matchMedia("(max-width: 480px)").matches?`<div class="efb fs-5 nmsgefb bi-exclamation-diamond-fill" onClick="alert_message_efb('${ajax_object_efm.text.enterTheEmail}','',10,'danger');"></div>`:ajax_object_efm.text.enterTheEmail;let a=0;const n=/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/;if(a+=e.value.match(n)?0:1,a>0){!e.value.match(n)&&(e.className=colorBorderChangerEfb(e.className,"border-danger")),Number(t)<525&&0==window.matchMedia("(max-width: 480px)").matches&&document.getElementById(`${e.id}-message`).classList.add("unpx"),document.getElementById(`${e.id}-message`).innerHTML=s,document.getElementById(`${e.id}-message`).classList.contains("show")&&document.getElementById(`${e.id}-message`).classList.add("show");const a=sendBack_emsFormBuilder_pub.findIndex((t=>t.id_==e.dataset.vid));-1!=a&&sendBack_emsFormBuilder_pub.splice(a,1)}else e.className=colorBorderChangerEfb(e.className,"border-success"),document.getElementById(`${e.id}-message`).classList.remove("show"),document.getElementById(`${e.id}-message`).innerHTML="";return!(a>0)}function valid_password_emsFormBuilder(e){const t=e.id;let s=document.getElementById("body_efb").offsetWidth;const a=Number(s)<380&&0==window.matchMedia("(max-width: 480px)").matches?`<div class="efb fs-5 nmsgefb bi-exclamation-diamond-fill" onClick="alert_message_efb('${ajax_object_efm.text.enterThePassword}','',10,'danger');"></div>`:efb_var.text.enterThePassword;if(e.value.length<3){e.className=colorBorderChangerEfb(e.className,"border-danger");const n=sendBack_emsFormBuilder_pub.findIndex((t=>t.id_==e.dataset.vid));return-1!=n&&sendBack_emsFormBuilder_pub.splice(n,1),Number(s)<525&&0==window.matchMedia("(max-width: 480px)").matches&&document.getElementById(`${t}-message`).classList.add("unpx"),document.getElementById(`${t}-message`).innerHTML=a,document.getElementById(`${e.id}-message`).classList.contains("show")&&document.getElementById(`${e.id}-message`).classList.add("show"),!1}return e.className=colorBorderChangerEfb(e.className,"border-success"),document.getElementById(`${t}-message`).innerHTML="",document.getElementById(`${t}-message`).classList.remove("show"),!0}function valid_phone_emsFormBuilder(e){let t=document.getElementById("body_efb").offsetWidth;const s=Number(t)<380&&0==window.matchMedia("(max-width: 480px)").matches?`<div class="efb fs-5 nmsgefb bi-exclamation-diamond-fill" onClick="alert_message_efb('${ajax_object_efm.text.enterThePhones}','',10,'danger');"></div>`:ajax_object_efm.text.enterThePhones;let a=0;const n=/^\s*(?:\+?(\d{1,3}))?([-. (]*(\d{3})[-. )]*)?((\d{3})[-. ]*(\d{2,4})(?:[-.x ]*(\d+))?)\s*$/gm,l=e.id;if(a+=e.value.match(n)?0:1,a>0){!e.value.match(n)&&(e.className=colorBorderChangerEfb(e.className,"border-danger"));const a=sendBack_emsFormBuilder_pub.findIndex((t=>t.id_==e.dataset.vid));-1!=a&&sendBack_emsFormBuilder_pub.splice(a,1),Number(t)<525&&0==window.matchMedia("(max-width: 480px)").matches&&document.getElementById(`${e.id}-message`).classList.add("unpx"),document.getElementById(`${l}-message`).innerHTML=s,document.getElementById(`${e.id}-message`).classList.contains("show")&&document.getElementById(`${e.id}-message`).classList.add("show")}else e.className=colorBorderChangerEfb(e.className,"border-success"),document.getElementById(`${l}-message`).innerHTML="",document.getElementById(`${l}-message`).classList.remove("show");return!(a>0)}function valid_file_emsFormBuilder(e,t){let s=document.getElementById(`${e}_-message`);s.innerHTML="",s.classList.remove("show"),document.getElementById(`${e}_`).classList.remove("border-danger");let a="";if(1){const t=valueJson_ws.find((t=>t.id_===e));a=t.file&&t.file.length>3?t.file:"Zip"}let n=0,l=!1;const r=`${e}_`;let o="";const i=document.getElementById(r);if(i.files[0]&&i.files[0].size<83e5){const e=i.files[0].type.length>1?i.files[0].type:i.files[0].name.slice(-1*(i.files[0].name.lastIndexOf(".")-1));1==validExtensions_efb_fun(a,e)&&(n=1,o=`${ajax_object_efm.text.pleaseUploadA} ${ajax_object_efm.text[a]}`)}if(n>0)s.innerHTML="",fun_upload_file_api_emsFormBuilder(e,a,t),l=!0;else{i.files[0]&&o.length<2&&(o=i.files[0].size<83e5?`${ajax_object_efm.text.pleaseUploadA} ${ajax_object_efm.text[a]}`:ajax_object_efm.text.fileSizeIsTooLarge);const e=colorTextChangerEfb(s.className,"text-danger");0!=e&&(s.className=e),s.innerHTML=o,s.classList.contains("show")||s.classList.add("show"),l=!1}return l}function fun_tracking_show_emsFormBuilder(){const e=1==pro_efb?10:3500,t=new URLSearchParams(location.search);let s=null!=t.get("track")?sanitize_text_efb(t.get("track")):null;s?(s=`value="${s}"`,change_url_back_persia_pay_efb()):s="",setTimeout((()=>{document.getElementById("body_tracker_emsFormBuilder").innerHTML=` \n  <div class="efb  ${1==ajax_object_efm.rtl?"rtl-text":""}" >\n                <div class="efb  card card-public row mb-3 pb-3 px-1" id="body_efb-track">\n                    <h4 class="efb  title-holder  col-12 mt-4 fs-3"><i class="efb  bi-check2-square title-icon mx-1 fs-3"></i> ${ajax_object_efm.text.pleaseEnterTheTracking}</h4>\n                <div class="efb  row col-md-12">\n                        <label for="trackingCodeEfb" class="efb fs-6 form-label mx-2 col-12">\n                        ${ajax_object_efm.text.trackingCode}:<span class="efb fs-8 text-danger mx-1">*</span></label>\n                        <div class="efb  col-12 text-center mx-2 row">\n                        <input type="text" class="efb input-efb form-control border-d efb-rounded text-labelEfb h-l-efb mb-2" placeholder="${ajax_object_efm.text.entrTrkngNo}" id="trackingCodeEfb" ${s}>\n                         \x3c!-- recaptcha  --\x3e\n                         ${1==setting_emsFormBuilder.scaptcha?`<div class="efb  row mx-3"><div id="gRecaptcha" class="efb g-recaptcha my-2 mx-2" data-sitekey="${setting_emsFormBuilder.siteKey}" data-callback="verifyCaptcha"></div><small class="efb text-danger" id="recaptcha-message"></small></div>`:""}\n                         \n                         \x3c!-- recaptcha end  --\x3e\n                         <button type="submit" class="efb fs-5  btn btn-pinkEfb col-12 text-white mb-1 "  id="vaid_check_emsFormBuilder" onclick="fun_vaid_tracker_check_emsFormBuilder()">\n                        <i class="efb fs-5  bi-search"></i> ${ajax_object_efm.text.search}  </button>\n                        </div>\n                    </div>\n                </div>\n                \n            \x3c!-- efb --\x3e            \n        </div>\n        <div id="alert_efb" class="efb mx-5"></div>\n`,1==setting_emsFormBuilder.scaptcha&&(sitekye_emsFormBuilder=setting_emsFormBuilder.siteKey,loadCaptcha_efb())}),e)}function fun_get_tracking_code(){}function fun_vaid_tracker_check_emsFormBuilder(){if(!navigator.onLine)return void noti_message_efb(efb_var.text.offlineSend,"danger","body_efb-track");const e=document.getElementById("vaid_check_emsFormBuilder").innerHTML;if(document.getElementById("vaid_check_emsFormBuilder").innerHTML='<i class="efb  bi-hourglass-split"></i>',document.getElementById("vaid_check_emsFormBuilder").classList.toggle("disabled"),el=document.getElementById("trackingCodeEfb").value,el.length<5)document.getElementById("vaid_check_emsFormBuilder").innerHTML=e,document.getElementById("vaid_check_emsFormBuilder").classList.toggle("disabled"),noti_message_efb(ajax_object_efm.text.trackingCodeIsNotValid,"danger","body_efb-track");else if(0==currentTab_emsFormBuilder){const t=sitekye_emsFormBuilder?grecaptcha.getResponse()||null:"not";null==t?(document.getElementById("vaid_check_emsFormBuilder").innerHTML=e,document.getElementById("vaid_check_emsFormBuilder").classList.toggle("disabled"),noti_message_efb(ajax_object_efm.text.checkedBoxIANotRobot,"danger","body_efb-track")):(data={action:"get_track_Emsfb",value:el,name:formNameEfb,valid:recaptcha_emsFormBuilder,nonce:ajax_object_efm.nonce,sid:efb_var.sid},recaptcha_emsFormBuilder=t,post_api_tracker_check_efb(data,e))}}function emsFormBuilder_show_content_message(e,t){const s=e.msg_id,a=e.track,n=e.date;let l=fun_emsFormBuilder_show_messages(JSON.parse(replaceContentMessageEfb(e.content)),"user",a,n);for(let e of t){l+=`<div class="efb   mb-3"><div class="efb  clearfix"> ${fun_emsFormBuilder_show_messages(JSON.parse(e.content.replace(/[\\]/g,"")),e.rsp_by,a,e.date)}</div></div>`}let r=`<div class="efb mx-2 mt-2"><div class="efb form-group mb-3" id="replay_section__emsFormBuilder">\n  <label for="replayM_emsFormBuilder" class:'efb mx-1 fs-7" id="label_replyM_efb">${ajax_object_efm.text.reply}:</label>\n  <textarea class="efb form-control border-d fs-6" id="replayM_emsFormBuilder" rows="5" data-id="${s}"></textarea>\n  \n  </div>\n  <div class="efb col text-right row my-2 mx-1">\n  <button type="submit" class="efb btn fs-5 btn-r btn-primary btn-lg" id="replayB_emsFormBuilder" OnClick="fun_send_replayMessage_emsFormBuilder(${s})">${ajax_object_efm.text.reply} </button>\n  \x3c!-- recaptcha  --\x3e\n  ${sitekye_emsFormBuilder?`<div class="efb row mx-3"><div class="efb g-recaptcha my-2 mx-2" data-sitekey="${sitekye_emsFormBuilder}" id="recaptcha"></div><small class="efb text-danger" id="recaptcha-message"></small></div>`:""}\n  \x3c!-- recaptcha end  --\x3e\n  <p class="efb mx-2 my-1 text-pinkEfb efb fs-7" id="replay_state__emsFormBuilder">  </p>\n  </div></div>\n  `;return`\n  <div class="efb modal-header efb">\n  <h5 class="efb modal-title fs-5"><i class="efb  bi-chat-square-text mx-2 mx-2"></i>\n   <span id="settingModalEfb-title">${ajax_object_efm.text.response}</span></h5>\n </div>\n  <div class="efb modal-body overflow-auto py-0 my-0  ${1==efb_var.rtl?"rtl-text":""}" id="resp_efb">\n    ${l} \n   </div>\n   ${r}\n   </div>\n   </div>\n</div>\n<div>\n</div></div>`}function fun_emsFormBuilder_show_messages(e,t,a,n){"w_link"==e[e.length-1].type&&e.pop();const l=setting_emsFormBuilder.hasOwnProperty("activeDlBtn")&&1==setting_emsFormBuilder.activeDlBtn?`<div class="efb col fs-4 h-d-efb pointer-efb text-darkb d-flex justify-content-end bi-download" data-toggle="tooltip" data-placement="bottom" title="${efb_var.text.download}" onClick="generatePDF_EFB('resp_efb')"></div>`:"";1==t?t="Admin":0!=t&&0!=t.length&&-1!=t.length||(t="visitor");let r=`<Div class="efb bg-response efb card-body my-2 py-2 ${1==efb_var.rtl?"rtl-text":""}">\n  <div class="efb  form-check">\n  <div>\n      <p class="efb small fs-7 mb-0"><span>${ajax_object_efm.text.by}:</span> ${t}</p>\n    ${0!=a?`<p class="efb small fs-7 mb-0"><span> ${ajax_object_efm.text.trackingCode}:</span> ${a} </p>`:""}\n    <p class="efb small fs-7 mb-0"><span>${ajax_object_efm.text.ddate}:</span> ${n} </p>  \n  </div>\n    ${l}\n  </div>\n <hr>\n `;e.sort(((e,t)=>Number(e.amount)>Number(t.amount)?1:-1));let o=[],i=[],d=e[0].hasOwnProperty("paymentcurrency")?e[0].paymentcurrency:"usd";for(const t of e){let a="<b></b>";if(t.hasOwnProperty("value")&&"maps"!=t.type&&(t.value=replaceContentMessageEfb(t.value),t.hasOwnProperty("qty")&&(t.qty=replaceContentMessageEfb(t.qty)),a=`<b>${t.value.toString().replaceAll("@efb!",",")}</b>`,0!=t.hasOwnProperty("qty")&&(a+=`: <b> ${t.qty}</b>`)),s=!1,"@file@"==t.value&&-1==o.findIndex((e=>e==t.url))){s=!0,o.push(t.url);t.url.slice(t.url.lastIndexOf("/")+1,t.url.lastIndexOf("."));if("Image"==t.type||"image"==t.type)a=`</br><img src="${t.url}" alt="${t.name}" class="efb img-thumbnail m-1">`;else if("Document"==t.type||"document"==t.type||"allformat"==t.type)a=`</br><a class="efb btn btn-primary m-1" href="${t.url}" target="_blank" >${ajax_object_efm.text.download}</a>`;else if("Media"==t.type||"media"==t.type){let e="video";if(["mp3","wav","ogg"].forEach((function(s){-1!==t.url.indexOf(s)&&(e="audio")})),"video"==e){const e=t.url.length,s=t.url.slice(e-t.url.lastIndexOf((e=>"."==e)),e);a="avi"!==s?`</br><div class="efb px-1"><video poster="${poster_emsFormBuilder}" src="${t.url}" type='video/${s}'controls></video></div><p class="efb text-center" ><a href="${t.url}">${efb_var.text.videoDownloadLink}</a></p>`:`<p class="efb text-center"><a href="${t.url}">${efb_var.text.downloadViedo}</a></p>`}else a=`<div ><audio controls><source src="${t.url}"></audio> </div>`}else a=t.url.length>1?`</br><a class="efb btn btn-primary" href="${t.url}" target="_blank" >${t.name}</a>`:'<span class="efb  fs-5">💤</span>'}else if("esign"==t.type){let e=t.hasOwnProperty("name")?t.name.toLowerCase():"";e=efb_var.text[e]||t.name,s=!0,a=`<img src="${t.value}" alt="${t.name}" class="efb img-thumbnail">`,r+=`<p class="efb fs-6 my-0 efb  form-check">${e}:</p> <p class="efb my-1 mx-3 fs-7 form-check"><br> ${a}</p>`}else if("color"==t.type){let e=t.hasOwnProperty("name")?t.name.toLowerCase():"";e=efb_var.text[e]||t.name,s=!0,a=`<div class="efb img-thumbnail"  style="background-color:${t.value}; height: 50px;">${t.value}</div>`,r+=`<p class="efb fs-6 my-0 efb  form-check">${e}:</p> <p class="efb my-1 mx-3 fs-7 form-check"><br> ${a}</p>`}else if("maps"==t.type)"object"==typeof t.value&&(s=!0,a=`<div id="${t.id_}-map" data-type="maps" class="efb  maps-efb h-d-efb  required " data-id="${t.id_}-el" data-name="maps"><h1>maps</h1></div>`,valj_efb.push({id_:t.id_,mark:-1,lat:t.value[0].lat,lng:t.value[0].lng,zoom:9,type:"maps"}),marker_maps_efb=t.value,initMap(!1),r+=a);else if("rating"==t.type){s=!0;let e=t.hasOwnProperty("name")?t.name.toLowerCase():"";e=efb_var.text[e]||t.name,a=`<div class='efb fs-4 star-checked star-efb mx-1 ${1==efb_var.rtl?"text-end":"text-start"}'>`;for(let e=0;e<parseInt(t.value);e++)a+='<i class="efb bi bi-star-fill"></i>';a+="</div>",r+=`<p class="efb fs-6 my-0 efb  form-check">${e}:</p> <p class="efb my-1 mx-3 fs-7 form-check">${a}</p>`}else if("checkbox"==t.type&&0==i.includes(t.id_)){s=!0;let a="null";i.push(t.id_);for(let s of e)"checkbox"==s.type&&s.id_==t.id_&&("null"==a?a=`<p class="efb my-1 mx-3 fs-7 form-check"><b> ${s.value}</b></p>`:a+=`<p class="efb my-1 mx-3 fs-7 form-check"><b> ${s.value}</b></p>`);r+=`<p class="efb fs-6 my-0 efb">${t.name}:</p>${a}`}if("passwordRegisterEFB"==t.id_&&(r+=a,a="**********"),(1==s&&"@file@"==t.value||0==s&&"@file@"!=t.value)&&"payment"!=t.id_&&"checkbox"!=t.type){let e=t.hasOwnProperty("name")?t.name.toLowerCase():"title";"file"==e&&(e="atcfle"),e=efb_var.text[e]||t.name;let s="<b>@file@</b>"!==a?a:"";t.type.includes("pay")&&"payment"!=t.id_?s+=`<span class="efb col fw-bold  text-labelEfb h-d-efb hStyleOpEfb d-flex justify-content-end">${Number(t.price).toLocaleString(lan_name_emsFormBuilder,{style:"currency",currency:d})}</span>`:t.type.includes("imgRadio")&&(s='<div class="efb w-25">'+fun_imgRadio_efb(t.id_,t.src,t)+"</div>"),r+=`<p class="efb fs-6 my-0 efb">${e}:</p><p class="efb my-1 mx-3 fs-7 test form-check">${s}</p>`}"payment"==t.type?"stripe"==t.paymentGateway?r+=`<div class="efb mx-3 fs7 bg-dark text-white text-capitalize  p-2 my-1">\n        <p class="efb fs-6 my-0">${efb_var.text.payment} ${efb_var.text.id}:<span class="efb mb-1"> ${t.paymentIntent}</span></p>\n            <p class="efb  my-0">${efb_var.text.payAmount}:<span class="efb mb-1"> ${Number(t.total).toLocaleString(lan_name_emsFormBuilder,{style:"currency",currency:d})}</span></p>\n            <p class="efb my-0">${efb_var.text.ddate}:<span class="efb mb-1"> ${t.paymentCreated}</span></p>\n            <p class="efb my-0">${efb_var.text.updated}:<span class="efb mb-1"> ${t.updatetime}</span></p>\n            <p class="efb  my-0">${efb_var.text.methodPayment}:<span class="efb mb-1"> ${t.paymentmethod}</span></p>\n            ${"charge"!=t.paymentmethod?`<p class="efb fs-6 my-0">${efb_var.text.interval}:<span class="efb mb-1 text-capitalize"> ${t.interval}</span></p>`:""}\n            </div>`:r+=`<div class="efb mx-3 fs7 bg-dark text-white text-capitalize p-2 my-1">\n            <p class="efb fs-6 my-0">${efb_var.text.payment} ${efb_var.text.id}:<span class="efb mb-1"> ${t.paymentIntent}</span></p>\n            <p class="efb my-0">${efb_var.text.payAmount}:<span class="efb mb-1"> ${t.total} ریال</span></p>\n            <p class="efb  my-0">${efb_var.text.methodPayment}:<span class="efb mb-1"> ${t.paymentmethod}</span></p>\n            <p class="efb my-0">${efb_var.text.ddate}:<span class="efb mb-1"> ${t.paymentCreated}</span></p>\n           \x3c!-- <p class="efb my-0">شماره کارت:<span class="efb mb-1"> ${t.paymentCard}</span></p>\n            <p class="efb my-0">کد پیگیری زرین پال<span class="efb mb-1"> ${t.refId}</span></p> --\x3e\n            </div>`:"closed"==t.type?stock_state_efb=!0:"opened"==t.type&&(stock_state_efb=!1)}return r+="</div>",r}function fun_send_replayMessage_emsFormBuilder(e){document.getElementById("replayB_emsFormBuilder").classList.add("disabled"),document.getElementById("replayB_emsFormBuilder").innerHTML='<i class="efb bi-hourglass-split mx-1"></i>'+efb_var.text.sending,setTimeout((()=>{let e=document.getElementById("replayM_emsFormBuilder").value.replace(/\n/g,"@efb@nq#");e=sanitize_text_efb(e);if(fun_sendBack_emsFormBuilder([{id_:"message",name:"message",type:"text",amount:0,value:e,by:ajax_object_efm.user_name.length>1?ajax_object_efm.user_name:efb_var.text.guest,session:sessionPub_emsFormBuilder}][0]),e.length<1)return check_msg_ext_resp_efb(),void(document.getElementById("replay_state__emsFormBuilder").innerHTML=`<h6 class="efb fs-6"><i class="efb bi-exclamation-triangle-fill nmsgefb"></i>${efb_var.text.error}${efb_var.text.pleaseEnterVaildValue}</h6>`);if(1==setting_emsFormBuilder.hasOwnProperty("dsupfile")&&1!=setting_emsFormBuilder.dsupfile)for(const e in sendBack_emsFormBuilder_pub)"file"==sendBack_emsFormBuilder_pub[e].name&&sendBack_emsFormBuilder_pub.splice(e,1);fun_send_replayMessage_reast_emsFormBuilder(sendBack_emsFormBuilder_pub)}),100)}function fun_send_replayMessage_reast_emsFormBuilder(e){navigator.onLine?(f_btn=()=>{document.getElementById("replay_state__emsFormBuilder").innerHTML=efb_var.text.enterYourMessage,document.getElementById("replayM_emsFormBuilder").innerHTML="",document.getElementById("replayB_emsFormBuilder").classList.remove("disabled")},e.length<1?f_btn():(data={action:"set_rMessage_id_Emsfb",type:"POST",id:efb_var.msg_id,valid:recaptcha_emsFormBuilder,message:JSON.stringify(e),nonce:ajax_object_efm.nonce,type:form_type_emsFormBuilder,nonce_msg:efb_var.nonce_msg,sid:efb_var.sid},post_api_r_message_efb(data,e))):noti_message_efb(efb_var.text.offlineSend,"danger","replay_state__emsFormBuilder")}function fun_emsFormBuilder__add_a_response_to_messages(e,t,s,a,n){const l=`<div class="efb   mb-3"><div class="efb  clearfix">${fun_emsFormBuilder_show_messages(e,t,a,n)}</div></div>`;document.getElementById("resp_efb").innerHTML+=l}function fun_show_alert_setting_emsFormBuilder(){const e=`<div class="efb alert alert-danger" role="alert"> <h2 class="efb font-weight-bold">\n            ${ajax_object_efm.text.error}</br>\n            ${ajax_object_efm.text.formIsNotShown}</br>\n            <a href="https://www.youtube.com/embed/a1jbMqunzkQ"  target="_blank" class="efb font-weight-normal">${ajax_object_efm.text.pleaseWatchTutorial}</a> </h2> </div>`;document.getElementById("body_emsFormBuilder")?document.getElementById("body_emsFormBuilder").innerHTML=e:document.getElementById("body_tracker_emsFormBuilder")?document.getElementById("body_tracker_emsFormBuilder").innerHTML=e:window.alert(`${ajax_object_efm.text.error} ${ajax_object_efm.text.formIsNotShown}`)}function validation_before_send_emsFormBuilder(){const e=valj_efb[0].hasOwnProperty("logic")&&1==valj_efb[0].logic?"logic_fun_prev_send()":"fun_prev_send()",t=[0,0];let s=0,a=0;for(const e of valueJson_ws)a+=1==e.required&&"file"!==e.type?1:0,"file"==e.type&&null==document.getElementById(`${e.id_}_`).files[0]&&1==e.required&&(s-=1);for(const e of sendBack_emsFormBuilder_pub)if(t[0]+=1,"@file@"==e.value){const a=valueJson_ws.findIndex((t=>t.id_==e.id_));if(-1!=a){if(valueJson_ws[a].hasOwnProperty("disabled")&&1==valueJson_ws[a].disabled&&(valueJson_ws[a].hasOwnProperty("hidden")&&0==valueJson_ws[a].hidden||0==valueJson_ws[a].hasOwnProperty("hidden"))){const e=sendBack_emsFormBuilder_pub.findIndex((e=>e.id_==valueJson_ws[a].id_));sendBack_emsFormBuilder_pub.splice(e,1),t[0]-=1;continue}e.url.length>5&&(s+=1==valueJson_ws[a].required?1:0,t[1]+=1)}}else if("@file@"!=e.type&&"payment"!=e.type){const a=valueJson_ws.findIndex((t=>t.id_==e.id_));if(-1!=a){if("multiselect"==valueJson_ws[a].type||"option"==valueJson_ws[a].type||"Select"==valueJson_ws[a].type||"payMultiselect"==valueJson_ws[a].type||"paySelect"==valueJson_ws[a].type){const e="multiselect"==valueJson_ws[a].type||"payMultiselect"==valueJson_ws[a].type?valueJson_ws.findIndex((e=>e.parent==valueJson_ws[a].id_)):valueJson_ws.findIndex((e=>e.parents==valueJson_ws[a].id_));s+=1==valueJson_ws[a].required&&e>-1?1:0}else if("chlCheckBox"==valueJson_ws[a].type){const e=valueJson_ws.findIndex((e=>e.parents==valueJson_ws[a].id_));s+=1==valueJson_ws[a].required&&e>-1?1:0}else s+=1==valueJson_ws[a].required?1:0;e.value.length>0&&(t[1]+=1)}}else e.value.length>0&&(t[1]+=1);if(a=a>s?1:0,!(0==t[1]&&0!=t[0]||0==t[0]&&0==t[1]||1==a)||1!=valj_efb[0].hasOwnProperty("logic")&&0!=valj_efb[0].hasOwnProperty("logic")||0!=valj_efb.logic)return!0;document.getElementById("efb-final-step").innerHTML=`<h3 class='efb emsFormBuilder'><i class="efb nmsgefb bi-exclamation-triangle-fill text-center fs-2 efb"></i></h1><h3 class="efb fs-3 efb text-muted">${ajax_object_efm.text.error}</h3> <span class="efb mb-2 fs-5 efb text-muted"> ${1!=a?ajax_object_efm.text.PleaseFillForm:ajax_object_efm.text.pleaseFillInRequiredFields} </br></span>\n     <div class="efb m-1"> <button id="prev_efb_send" type="button" class="efb btn efb ${valj_efb[0].button_color}   ${valj_efb[0].hasOwnProperty("corner")?valj_efb[0].corner:"efb-square"}   ${valj_efb[0].el_height}  p-2 text-center  btn-lg  " onClick="${e}"><i class="efb  ${valj_efb[0].button_Previous_icon} ${valj_efb[0].button_Previous_icon} ${valj_efb[0].icon_color} mx-2 fs-6 " id="button_group_Previous_icon"></i><span id="button_group_Previous_button_text" class="efb  ${valj_efb[0].el_text_color} ">${valj_efb[0].button_Previous_text}</span></button></div></div>`,document.getElementById("body_efb")&&document.getElementById("body_efb").scrollIntoView({behavior:"smooth",block:"center",inline:"center"});for(const e of valueJson_ws)if("file"!=e.type&&"dadfile"!=e.type&&"checkbox"!=e.type&&"radiobutton"!=e.type&&"option"!=e.type&&"multiselect"!=e.type&&"select"!=e.type&&"payMultiselect"!=e.type&&"paySelect"!=e.type&&"payRadio"!=e.type&&"payCheckbox"!=e.type&&"chlCheckBox"!=e.type)return e.id_&&document.getElementById(e.id_).value.length<5&&(document.getElementById(`${e.id_}-message`).innerHTML=ajax_object_efm.text.enterTheValueThisField),!1}function show_user_profile_emsFormBuilder(e){return`<div class="efb mt-5"><div class="efb card-block text-center text-dark ">\n              <div class="efb mb-3 d-flex justify-content-center"> <img src="${e.user_image}" class="efb userProfileImageEFB" alt="${e.display_name}"> </div>\n              <h6 class="efb  fs-5 mb-1 d-flex justify-content-center text-dark">${e.display_name}</h6> <p class="efb  fs-6">${e.user_login}</p>                          \n              <button type="button"  class="efb btn fs-5 btn-lg btn-danger efb mt-1 " onclick="emsFormBuilder_logout()">${ajax_object_efm.text.logout}</button>\n          </div> </div>`}function emsFormBuilder_logout(){document.getElementById("body_efb").innerHTML=loading_messge_efb(),form_type_emsFormBuilder="logout",formNameEfb="logout",ajax_object_efm.type="logout",sendBack_emsFormBuilder_pub={logout:!0},recaptcha_emsFormBuilder="",actionSendData_emsFormBuilder()}function Show_recovery_pass_efb(){let e=document.getElementById("recoverySectionemsFormBuilder");if(e.style.display="none"==e.style.display?"block":"none",document.getElementById("recoverySectionemsFormBuilder").scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),e=document.getElementById("btn_recovery_pass_efb"),e.disabled=!0,1==e.dataset.id){e.dataset.id=0;const t=document.getElementById("username_recovery_pass_efb"),s=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;e.addEventListener("click",(e=>{form_type_emsFormBuilder="recovery",formNameEfb=form_type_emsFormBuilder,sendBack_emsFormBuilder_pub={email:t.value,recovery:!0},document.getElementById("efb-final-step").innerHTML=`<h1 class="efb fas fa-sync fa-spin text-primary emsFormBuilder"></h1> <h3>${ajax_object_efm.text.pleaseWaiting}<h3>`,actionSendData_emsFormBuilder()})),t.addEventListener("keyup",(a=>{0==(t.value.match(s)?0:1)?e.classList.remove("disabled"):1!=e.classList.contains("disabled")&&e.classList.add("disabled")}))}}function response_fill_form_efb(e){let t="";if(valj_efb.length>1&&(t=valj_efb[0].hasOwnProperty("logic")&&1==valj_efb[0].logic?"logic_fun_prev_send()":"fun_prev_send()"),1==e.data.success){if(null!=e.data.track&&fun_send_mail_emsFormBuilder(e.data.track,e.data.nonce,"msg"),valj_efb.length>0&&1==valj_efb[0].hasOwnProperty("thank_you")&&"rdrct"==valj_efb[0].thank_you)return document.getElementById("efb-final-step").innerHTML=`\n      <h3 class="efb fs-4">${efb_var.text.sentSuccessfully}</h3>\n      <h3 class="efb">${efb_var.text.pWRedirect} <a class="efb text-darkb" href="${e.data.m}">${efb_var.text.orClickHere}</a></h3>\n      `,void(window.location.href=e.data.m);switch(form_type_emsFormBuilder){case"form":case"survey":case"payment":document.getElementById("efb-final-step").innerHTML=funTnxEfb(e.data.track),localStorage.clear();break;case"subscribe":document.getElementById("efb-final-step").innerHTML=`<h3 class='efb emsFormBuilder fs-4'><i class="efb fs-2 bi-hand-thumbs-up text-primary""></i></h3><h3 class='efb emsFormBuilder fs-5'>${valj_efb[0].thank_you_message.thankYou}</h3></br> <span class="efb fs-5">${ajax_object_efm.text.YouSubscribed}</span></br></br></h3>`,localStorage.clear();break;case"register":const t="recovery"!=form_type_emsFormBuilder?valj_efb[0].thank_you_message.thankYou:ajax_object_efm.text.checkYourEmail;document.getElementById("efb-final-step").innerHTML=funTnxEfb("","",t);break;case"recovery":document.getElementById("efb-final-step").innerHTML=`<h3 class='efb emsFormBuilder fs-4'><i class="efb fs-2 bi-envelope text-primary""></i></h3><h3 class='efb emsFormBuilder fs-5'>${e.data.m}</h3></br></br></h3>`;break;case"login":1==e.data.m.state?(document.getElementById("body_efb").innerHTML=show_user_profile_emsFormBuilder(e.data.m),location.reload()):document.getElementById("efb-final-step").innerHTML=`<h3 class='efb emsFormBuilder text-center fs-5 efb mb-0 mt-5'><i class="efb fs-2 bi-exclamation-triangle-fill nmsgefb"></i></h3> <span class="efb fs-7"> <br>${e.data.m.error}</span>\n           </br>\n           <a  id="btn_Show_recovery_efb" class="efb pointer-efb emsFormBuilder " onClick="Show_recovery_pass_efb()" >${ajax_object_efm.text.passwordRecovery} </a>\n           <div class="efb py-5 px-2 container bg-light mb-3" id="recoverySectionemsFormBuilder" style="display: none;">     \n              <input type="email" id="username_recovery_pass_efb" class="efb px-2 mb-1 emsFormBuilder_v  h-d-efb efb-square col-8" placeholder="Email" >\n              <a  id="btn_recovery_pass_efb" class=" efb btn h-d-efb btn-block btn-pinkEfb text-white mb-2 get-emsFormBuilder disabled" data-id="1" >${ajax_object_efm.text.send}</a>\n              </div>\n              <div class="efb m-1"> <button id="prev_efb_send" type="button" class="efb btn efb ${valj_efb[0].button_color}   ${valj_efb[0].hasOwnProperty("corner")?valj_efb[0].corner:"efb-square"}   ${valj_efb[0].el_height}  p-2 text-center  btn-lg  " onClick="fun_prev_send()"><i class="efb  ${valj_efb[0].button_Previous_icon} ${valj_efb[0].button_Previous_icon} ${valj_efb[0].icon_color} mx-2 fs-6 " id="button_group_Previous_icon"></i><span id="button_group_Previous_button_text" class="efb  ${valj_efb[0].el_text_color} ">${valj_efb[0].button_Previous_text}</span></button></div>\n              `;break;case"logout":location.reload(),localStorage.clear();break}document.getElementById("body_efb")&&document.getElementById("body_efb").scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}else document.getElementById("efb-final-step")?document.getElementById("efb-final-step").innerHTML=`<h3 class='efb emsFormBuilder'><i class="efb nmsgefb bi-exclamation-triangle-fill text-center efb fs-3"></i></h1><h3 class="efb  fs-3 text-muted">${ajax_object_efm.text.error}</h3> <span class="efb mb-2 efb fs-5"> ${e.data.m}</span>\n    <div class="efb m-1"> <button id="prev_efb_send" type="button" class="efb btn efb ${valj_efb[0].hasOwnProperty("button_color")?valj_efb[0].button_color:"btn-darkb"}   ${valj_efb[0].hasOwnProperty("corner")?valj_efb[0].corner:"efb-square"}   ${valj_efb[0].hasOwnProperty("el_height")?valj_efb[0].el_height:"h-l-efb"}  p-2 text-center  btn-lg  " onClick="${t}"><i class="efb  ${valj_efb[0].button_Previous_icon} ${valj_efb[0].button_Previous_icon} ${valj_efb[0].icon_color} mx-2 fs-6 " id="button_group_Previous_icon"></i><span id="button_group_Previous_button_text" class="efb  ${valj_efb[0].el_text_color} ">${valj_efb[0].button_Previous_text}</span></button></div></div>`:alert_message_efb(e.data.m,"",14,"warning")}function response_Valid_tracker_efb(e){1==e.data.success?(document.getElementById("body_efb-track").innerHTML=emsFormBuilder_show_content_message(e.data.value,e.data.content),setTimeout((()=>{"function"==typeof reply_attach_efb&&reply_attach_efb(e.data.value.msg_id),state_rply_btn_efb(100)}),50)):document.getElementById("body_efb-track").innerHTML=`<div class="efb text-center"><h3 class='efb emsFormBuilder mt-3'><i class="efb nmsgefb  bi-exclamation-triangle-fill text-center efb fs-1"></i></h1><h3 class="efb  fs-3 text-muted">${ajax_object_efm.text.error}</h3> <span class="efb mb-2 efb fs-5 mx-1">${ajax_object_efm.text.somethingWentWrongTryAgain} </br></br> ${e.data.m} </br></span>\n     <div class="efb display-btn emsFormBuilder"> <button type="button" id="emsFormBuilder-text-prevBtn-view" class="efb  btn btn-darkb m-5 text-white" onClick="(() => {  location.reload(); })()" style="display;"><i class="efb ${1==ajax_object_efm.rtl?"bi-arrow-right":"bi-arrow-left"}"></i></button></div></div>`}function response_rMessage_id(e,t){if(1==e.success&&1==e.data.success){document.getElementById("replayM_emsFormBuilder").value="",document.getElementById("replay_state__emsFormBuilder").innerHTML=e.data.m,document.getElementById("replayB_emsFormBuilder").classList.remove("disabled"),document.getElementById("replayB_emsFormBuilder").innerHTML=ajax_object_efm.text.reply,document.getElementById("name_attach_efb")&&(document.getElementById("name_attach_efb").innerHTML=ajax_object_efm.text.file);const s=Date();fun_emsFormBuilder__add_a_response_to_messages(t,e.data.by,0,0,s);const a=document.getElementById("resp_efb");a.scrollTop=a.scrollHeight}else document.getElementById("replayB_emsFormBuilder").innerHTML=ajax_object_efm.text.reply,document.getElementById("replay_state__emsFormBuilder").innerHTML=`<p class="efb text-danger">${e.data.m}</p>`}function loadCaptcha_efb(){window.grecaptcha&&window.grecaptcha.render?(0!=valj_efb.length&&1==valj_efb[0].steps&&document.getElementById("btn_send_efb").classList.toggle("disabled"),grecaptcha.render("gRecaptcha",{sitekey:sitekye_emsFormBuilder})):setTimeout((()=>{this.loadCaptcha_efb()}),500)}function calPLenEfb(e){let t=2;return t=e<=5?40:e>5&&e<=10?20:e>10&&e<=50?15:e>50&&e<=100?9:e>100&&e<=300?3:e>300&&e<=600?1.5:e>600&&e<=1e3?1.2:1.1,t}ajax_object_efm.hasOwnProperty("ajax_value")&&"string"==typeof ajax_object_efm.ajax_value&&(g_timeout_efb=(ajax_object_efm.ajax_value.match(/id_/g)||[]).length,g_timeout_efb*=calPLenEfb(g_timeout_efb)),g_timeout_efb="object"==typeof ajax_object_efm&&"string"==typeof ajax_object_efm.ajax_value?g_timeout_efb:1100,setTimeout((()=>{var e;jQuery((function(){if("undefined"!=typeof ajax_object_efm){if(poster_emsFormBuilder=ajax_object_efm.poster,efb_var=ajax_object_efm,null!=localStorage.getItem("v_efb")&&localStorage.getItem("v_efb")==efb_var.v_efb||(localStorage.setItem("v_efb",efb_var.v_efb),location.reload(!0)),lan_name_emsFormBuilder=efb_var.language.slice(0,2),pro_efb="1"==ajax_object_efm.pro,page_state_efb="public",localStorage.setItem("form_id",efb_var.id),setting_emsFormBuilder=JSON.parse(ajax_object_efm.form_setting.replace(/[\\]/g,"")),"tracker"!=ajax_object_efm.state){const e="string"==typeof ajax_object_efm.ajax_value?JSON.parse(ajax_object_efm.ajax_value.replace(/[\\]/g,"")):ajax_object_efm.ajax_value;if(ajax_object_efm.form_setting&&ajax_object_efm.form_setting.length>0&&ajax_object_efm.form_setting!==ajax_object_efm.text.settingsNfound){form_type_emsFormBuilder=ajax_object_efm.type;const t=setting_emsFormBuilder;addons_emsFormBuilder=t.addons,"userIsLogin"!=ajax_object_efm.type?1==e[0].captcha?sitekye_emsFormBuilder=t.siteKey:sitekye_emsFormBuilder="":form_type_emsFormBuilder=ajax_object_efm.type}}"settingError"!==ajax_object_efm.state?"form"==ajax_object_efm.state?fun_render_view_efb(ajax_object_efm.ajax_value,1):"tracker"==ajax_object_efm.state?fun_tracking_show_emsFormBuilder():"settingError"==ajax_object_efm.state?fun_show_alert_setting_emsFormBuilder():"userIsLogin"==ajax_object_efm.state&&(document.getElementById("body_efb").innerHTML=show_user_profile_emsFormBuilder(ajax_object_efm.ajax_value)):fun_show_alert_setting_emsFormBuilder()}})),e={init:function(e,t,s,a){createMultiselect(e,t,s,a)}},motus_efb.ElementMultiselect=e}),g_timeout_efb),fun_text_forbiden_convert_efb=e=>e=(e=(e=(e=(e=(e=(e=(e=e.replaceAll("'","@efb@sq#")).replaceAll("`","@efb@vq#")).replaceAll('"',"@efb@dq#")).replaceAll("\t"," ")).replaceAll("\b"," ")).replaceAll("\r","@efb@nq#")).replaceAll("\n","@efb@nq#")).replaceAll("\r"," "),remove_ttmsg_efb=e=>{document.getElementById(`${e}_-message`)&&(document.getElementById(`${e}_-message`).classList.remove("show"),document.getElementById(`${e}_-message`).innerHTML="")},change_url_back_persia_pay_efb=()=>{const e=document.URL.indexOf("?");-1!=e&&history.pushState({page_id:1},`${document.title} !`,document.URL.slice(0,e))},window.addEventListener("popstate",(e=>{-1!=e.state.search("EFBstep-")&&(Number(e.state.slice(8))<=Number(current_s_efb)?prev_btn_efb():jQuery("#next_efb").trigger("click"))})),fun_gets_url_efb=()=>{const e=new URLSearchParams(location.search),t=e.getAll("iefb"),s=e.getAll("hefb"),a=e.getAll("sefb"),n=e.getAll("defb"),l=e.getAll("vefb");if(t.length>0)for(let e in t){const r=t[e],o=valj_efb.findIndex((e=>e.id_==r));let i=-1,d="string";if(1==valj_efb[o].hasOwnProperty("parent")&&(i=valj_efb.findIndex((e=>e.id_==valj_efb[o].parent))),-1!=i&&(d=valj_efb[i].type.toLowerCase(),d=1==d.includes("select")&&0==d.includes("multi")||1==d.includes("radio")?"string":"array"),a.length>0&&a.length>e){if(-1==i)continue;if("string"==d)1==a[e]&&(valj_efb[i].value=r);else{d=typeof valj_efb[i].value;const t="string"!=d?valj_efb[i].value.findIndex((e=>e==r)):-2;1==a[e]?-1==t?valj_efb[i].value.push(r):-2==t&&(valj_efb[i].value=[r]):t>-1&&valj_efb[i].value.splice(t,1)}}n.length>0&&n.length>e&&(i=-1!=i?i:o,1==n[e]?valj_efb[i].disabled=1:0==n[e]&&(valj_efb[i].disabled=0)),s.length>0&&s.length>e&&(i=-1!=i?i:o,1==s[e]?valj_efb[i].hidden=1:0==s[e]&&(valj_efb[i].hidden=0)),l.length>0&&l.length>e&&-1==i&&(valj_efb[e].value=l[e])}},fun_booking_avilable=e=>{let t=[!0,""],s=e.id;"select"!=e.type&&"select-one"!=e.type||(s=e.options[e.selectedIndex].dataset.id);const a=valj_efb.find((e=>e.id_==s)),n=(new Date).toLocaleDateString("fr-CA",{year:"numeric",month:"2-digit",day:"2-digit"});return uncheck=()=>{"radio"!=e.type&&"checkbox"!=e.type||(e.checked=!1)},"object"!=typeof a?(t=[!1,"Row not Found! contact to admin"],uncheck(),t):a.hasOwnProperty("dateExp")&&a.dateExp<n?(t=[!1,"Sorry, the selected option is no longer available as its expiration date has passed. Please choose another option."],uncheck(),t):a.hasOwnProperty("mlen")&&Number(a.mlen)<=Number(a.registered_count)?(t=[!1,"Unfortunately, the option you selected is no longer available. Please choose from the other available options."],uncheck(),t):t},post_api_forms_efb=e=>{const t=efb_var.rest_url+"Emsfb/v1/forms/message/add",s=new Headers({"Content-Type":"application/json"}),a=JSON.stringify(e);fetch(t,{method:"POST",headers:s,body:a}).then((e=>e.json())).then((e=>{response_fill_form_efb(e)})).catch((e=>{response_fill_form_efb({success:!1,data:{success:!1,m:ajax_object_efm.text.eJQ500}})})),document.getElementById("prev_efb")&&0==document.getElementById("prev_efb").classList.contains("d-none")&&document.getElementById("prev_efb").classList.add("d-none"),document.getElementById("next_efb")&&0==document.getElementById("next_efb").classList.contains("d-none")&&document.getElementById("next_efb").classList.add("d-none")},post_api_tracker_check_efb=(e,t)=>{const s=efb_var.rest_url+"Emsfb/v1/forms/response/get",a=new Headers({"Content-Type":"application/json"}),n=JSON.stringify(e);fetch(s,{method:"POST",headers:a,body:n}).then((e=>e.json())).then((e=>{document.getElementById("vaid_check_emsFormBuilder")&&(document.getElementById("vaid_check_emsFormBuilder").innerHTML=t,document.getElementById("vaid_check_emsFormBuilder").classList.toggle("disabled")),response_Valid_tracker_efb(e),efb_var.nonce_msg=e.data.nonce_msg,efb_var.msg_id=e.data.id})).catch((e=>{document.getElementById("vaid_check_emsFormBuilder").innerHTML=t,document.getElementById("vaid_check_emsFormBuilder").classList.toggle("disabled"),response_Valid_tracker_efb({success:!1,data:{success:!1,m:e}})}))},post_api_r_message_efb=(e,t)=>{const s=efb_var.rest_url+"Emsfb/v1/forms/response/add",a=new Headers({"Content-Type":"application/json"}),n=JSON.stringify(e);fetch(s,{method:"POST",headers:a,body:n}).then((e=>e.json())).then((e=>{response_rMessage_id(e,t),sendBack_emsFormBuilder_pub=[]})).catch((e=>{response_Valid_tracker_efb({success:!1,data:{success:!1,m:e}})}))};