let exportView_emsFormBuilder=[],stepsCount,sendBack_emsFormBuilder_pub=[],sessionPub_emsFormBuilder="reciveFromClient",stepNames_emsFormBuilder=["t","",""],currentTab_emsFormBuilder=0,multiSelectElemnets_emsFormBuilder=[],formNameEfb="",files_emsFormBuilder=[],addons_emsFormBuilder="",recaptcha_emsFormBuilder="",poster_emsFormBuilder="";const fileSizeLimite_emsFormBuilder=83e5;let select_options_emsFormBuilder=[],form_type_emsFormBuilder="form",valueJson_ws=[],motus_efb={},g_timeout_efb=100,price_efb="";function fun_render_view_efb(val,check){var url=new URL(window.location);history.replaceState("EFBstep-1",null,url),exportView_emsFormBuilder=[],(valueJson_ws=JSON.parse(val.replace(/[\\]/g,"")))[0].email="",valj_efb=valueJson_ws,fun_gets_url_efb(),formNameEfb=valj_efb[0].formName,state_efb="run",previewFormEfb("run"),valj_efb[0].hasOwnProperty("logic")&&1==valj_efb[0].logic&&(stack_steps_efb.push(1),logic_ui_forms_efb()),"payment"==form_type_emsFormBuilder&&setTimeout(()=>{fun_total_pay_efb()},2*valj_efb.length)}function createStepsOfPublic(){for(let el of document.querySelectorAll(".emsFormBuilder_v"))if("submit"!=el.type){switch(el.type){case"file":var ob=valueJson_ws.find(x=>x.id_===el.dataset.vid);(ob.hasOwnProperty("disabled")&&1!=ob.disabled||0==ob.hasOwnProperty("disabled"))&&(ob.hasOwnProperty("hidden")&&1==ob.hidden||0==ob.hasOwnProperty("hidden"))&&files_emsFormBuilder.push({id_:ob.id_,value:"@file@",state:0,url:"",type:"file",name:ob.name,session:sessionPub_emsFormBuilder});break;case"hidden":break;case"checkbox":case"radio":document.getElementById(el.id).addEventListener("change",e=>{el.dataset.tag&&0!=el.dataset.tag.includes("chl")||el.classList.contains("payefb")&&valj_efb[0].type})}el.addEventListener("change",e=>{handle_change_event_efb(el)}),"text"==el.type&&el.classList.contains("hijri-picker")&&$("#"+el.id).on("dp.change",function(arg){arg.date?(arg.date,handle_change_event_efb(el)):$("#selected-date").html("")})}else"checkbox"==el.type&&"payment"==valj_efb[0].type&&el.classList.contains("payefb")?(fun_sendBack_emsFormBuilder(o[0]),fun_total_pay_efb()):"submit"==el.type&&el.addEventListener("click",e=>{const id_=el.dataset.vid;var q,ob=valueJson_ws.find(x=>x.id_===id_),ob=[{id_:id_,name:ob.name,id_ob:el.id,amount:ob.amount,type:el.type,value:el.value,session:sessionPub_emsFormBuilder}];"payment"==valj_efb[0].type&&el.classList.contains("payefb")?(q=valueJson_ws.find(x=>x.id_===el.id),q=0<price_efb.length?{price:""}:{price:q.price},Object.assign(ob[0],q),fun_sendBack_emsFormBuilder(ob[0]),fun_total_pay_efb()):fun_sendBack_emsFormBuilder(ob[0])})}function handle_change_event_efb(el){validate_len=()=>{var m,offsetw=document.getElementById("body_efb").offsetWidth,len=el.hasAttribute("minlength")?el.minLength:"number"!=el.type?2:0;if(value.length<len&&"number"!=el.type)return state=!1,el.className=colorBorderChangerEfb(el.className,"border-danger"),vd=document.getElementById(el.id+"-message"),m=ajax_object_efm.text.mmplen.replace("NN",len),m=Number(offsetw)<380&&0==window.matchMedia("(max-width: 480px)").matches?`<div class="efb fs-5 nmsgefb bi-exclamation-diamond-fill" onClick="alert_message_efb('${m}','',10,'danger')"></div>`:m,vd&&(Number(offsetw)<525&&0==window.matchMedia("(max-width: 480px)").matches&&vd.classList.add("unpx"),vd.innerHTML=m,vd.classList.add("show")),-1!=(m=sendBack_emsFormBuilder_pub.findIndex(x=>x.id_==id_))&&sendBack_emsFormBuilder_pub.splice(m,1),0;if(value<len&&"number"==el.type){state=!1,el.className=colorBorderChangerEfb(el.className,"border-danger"),vd=document.getElementById(el.id+"-message");let m=ajax_object_efm.text.mcplen.replace("NN",len),msg=Number(offsetw)<380&&0==window.matchMedia("(max-width: 480px)").matches?`<div class="efb fs-5 nmsgefb bi-exclamation-diamond-fill" onClick="alert_message_efb('${m}','',10,'danger')"></div>`:m;vd&&(Number(offsetw)<525&&0==window.matchMedia("(max-width: 480px)").matches&&vd.classList.add("unpx"),vd.innerHTML=msg,vd.classList.add("show"));const i=sendBack_emsFormBuilder_pub.findIndex(x=>x.id_==id_);return-1!=i&&sendBack_emsFormBuilder_pub.splice(i,1),0}if(0!=(len=el.hasAttribute("maxlength")?el.maxLength:0)){if(value.length>len&&"number"!=el.type){state=!1,el.className=colorBorderChangerEfb(el.className,"border-danger"),vd=document.getElementById(el.id+"-message");let m=ajax_object_efm.text.mmxplen.replace("NN",len),msg=Number(offsetw)<380&&0==window.matchMedia("(max-width: 480px)").matches?`<div class="efb fs-5 nmsgefb bi-exclamation-diamond-fill" onClick="alert_message_efb('${m}','',10,'danger')"></div>`:m;vd&&(Number(offsetw)<525&&0==window.matchMedia("(max-width: 480px)").matches&&vd.classList.add("unpx"),vd.innerHTML=msg,vd.classList.add("show"));const i=sendBack_emsFormBuilder_pub.findIndex(x=>x.id_==id_);return-1!=i&&sendBack_emsFormBuilder_pub.splice(i,1),0}if(value>len&&"number"==el.type){state=!1,el.className=colorBorderChangerEfb(el.className,"border-danger"),vd=document.getElementById(el.id+"-message");let m=ajax_object_efm.text.mxcplen.replace("NN",len),msg=Number(offsetw)<380&&0==window.matchMedia("(max-width: 480px)").matches?`<div class="efb fs-5 nmsgefb bi-exclamation-diamond-fill" onClick="alert_message_efb('${m}','',10,'danger')"></div>`:m;vd&&(Number(offsetw)<525&&0==window.matchMedia("(max-width: 480px)").matches&&vd.classList.add("unpx"),vd.innerHTML=msg,vd.classList.add("show"));const i=sendBack_emsFormBuilder_pub.findIndex(x=>x.id_==id_);return-1!=i&&sendBack_emsFormBuilder_pub.splice(i,1),0}}return 1};let ob=valueJson_ws.find(x=>x.id_===el.dataset.vid),value="";const id_=el.dataset.vid;let state;ob||0!=el.id.includes("chl")&&(ob=sendBack_emsFormBuilder_pub.find(x=>x.id_ob===el.dataset.id));let vd;if(valj_efb[0].hasOwnProperty("booking")&&1==Number(valj_efb[0].booking)){var r=fun_booking_avilable(el);if(0==r[0])return void alert_message_efb(r[1],"",150,"danger")}switch(el.type){case"text":case"color":case"number":case"date":case"textarea":var outp="textarea"==el.type;if(value=sanitize_text_efb(el.value,outp),1==el.classList.contains("intlPhone"))return;if(0==validate_len())return;-1!=value.search('"')&&(el.value=value.replaceAll('"',""),noti_message_efb(`Don't use forbidden Character like: "`,"danger",`step-${current_s_efb}-efb-msg`)),el.className=colorBorderChangerEfb(el.className,"border-success"),(vd=document.getElementById(el.id+"-message"))&&vd.classList.remove("show");break;case"url":null==el.value.match(/^https?:\/\/(?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b(?:[-a-zA-Z0-9()@:%_\+.~#?&\/=]*)$/g)?(valid=!1,vd=document.getElementById(el.id+"-message"),el.className=colorBorderChangerEfb(el.className,"border-danger"),vd.innerHTML=ajax_object_efm.text.enterValidURL,vd.classList.contains("show")&&vd.classList.add("show")):(valid=!0,value=el.value,(vd=document.getElementById(el.id+"-message")).classList.remove("show"),vd.innerHTML="",el.className=colorBorderChangerEfb(el.className,"border-success"));break;case"checkbox":case"radio":if(value=sanitize_text_efb(el.value),"switch"==ob.type&&(value=1==el.checked?ajax_object_efm.text.on:ajax_object_efm.text.off),vd=document.getElementById(ob.id_+"_-message"),1<el.value.length||1==el.checked?(vd.classList.remove("show"),vd.innerHTML=""):(vd.innerHTML=ajax_object_efm.text.enterTheValueThisField,vd.classList.contains("show")&&vd.classList.add("show")),0==el.checked&&"checkbox"==el.type){const indx=sendBack_emsFormBuilder_pub.findIndex(x=>x.id_ob==el.id);if(-1!=indx)return sendBack_emsFormBuilder_pub.splice(indx,1),"payCheckbox"==ob.type&&fun_total_pay_efb(),void(valj_efb[0].hasOwnProperty("logic")&&valj_efb[0].logic&&fun_statement_logic_efb(el.id,el.type))}var id,outp=valj_efb.findIndex(x=>x.id_==el.name);if(-1!=outp&&0!=valj_efb[outp].type.includes("chl")&&1==el.checked)"checkbox"==el.type&&(id=el.id+"_chl",document.getElementById(id).disabled=!1);else if(-1!=outp&&0!=valj_efb[outp].type.includes("chl")&&0==el.checked){const id=el.id+"_chl";document.getElementById(id).disabled=!0,document.getElementById(id).value=""}valj_efb[0].hasOwnProperty("logic")&&valj_efb[0].logic&&fun_statement_logic_efb(el.id,el.type);break;case"select-one":case"select":if(value=sanitize_text_efb(el.value),(vd=document.getElementById(ob.id_+"_-message")).classList.remove("show"),vd.innerHTML="",el.className=colorBorderChangerEfb(el.className,"border-success"),"payment"==valj_efb[0].type&&el.classList.contains("payefb")){let v=el.options[el.selectedIndex].id;"string"==typeof(v=valueJson_ws.find(x=>x.id_==v&&x.value==el.value)).price&&(price_efb=v.price)}valj_efb[0].hasOwnProperty("logic")&&valj_efb[0].logic&&fun_statement_logic_efb(el.dataset.vid,el.type);break;case"range":value=sanitize_text_efb(el.value),(vd=document.getElementById(ob.id_+"_-message")).classList.remove("show"),vd.innerHTML="";break;case"email":state=valid_email_emsFormBuilder(el),value=1==state?sanitize_text_efb(el.value):"";break;case"tel":state=valid_phone_emsFormBuilder(el),value=1==state?sanitize_text_efb(el.value):"";break;case"password":state=valid_password_emsFormBuilder(el),value=1==state?sanitize_text_efb(el.value):"";break;case"select-multiple":el.name;if(1==el.classList.contains("multiple-emsFormBuilder"))for(let i=0;i<el.children.length;i++)value+=el.children[i].value+",";break;case"file":valid_file_emsFormBuilder(id_,"msg");break;case"hidden":value=sanitize_text_efb(el.value);break;case void 0:let check=!1;for(var ex of exportView_emsFormBuilder)if(ex.id_==el.id){check=!0;break}if(1==check){ob=valueJson_ws.find(x=>x.id_===el.id);for(var o of select_options_emsFormBuilder)value+=o+","}break;default:vd=document.getElementById(ob.id_+"_-message"),ob||(vd.classList.remove("show"),vd.innerHTML="")}if(""!=value||1<value.length){var r=ob.type,id_ob=("paySelect"!=ob.type?el:el.options[el.selectedIndex]).id;let o=[{id_:id_,name:ob.name,id_ob:id_ob,amount:ob.amount,type:r,value:value,session:sessionPub_emsFormBuilder}];"payment"==valj_efb[0].type&&el.classList.contains("payefb")?(id_ob=valueJson_ws.find(x=>x.id_===el.id),id_ob=0<price_efb.length?{price:price}:{price:id_ob.price},Object.assign(o[0],id_ob),fun_sendBack_emsFormBuilder(o[0]),fun_total_pay_efb()):(r.includes("chl")?(r=(id_ob=el.id.includes("_chl"))?document.getElementById(el.id).value:"",0==id_ob?Object.assign(o[0],{qty:r}):(el.classList.remove("bg-danger"),ob.qty=fun_text_forbiden_convert_efb(r),o[0]="")):o[0].type,fun_sendBack_emsFormBuilder(o[0]))}}function fun_sendBack_emsFormBuilder(ob){if("string"!=typeof ob){if(remove_ttmsg_efb(ob.id_),ob.hasOwnProperty("value")&&"number"!=typeof ob.value&&"object"!=typeof ob.value?ob.value=fun_text_forbiden_convert_efb(ob.value):ob.hasOwnProperty("value")&&"object"==typeof ob.value&&"maps"==ob.type&&(ob.value=ob.value),0<sendBack_emsFormBuilder_pub.length){let indx=sendBack_emsFormBuilder_pub.findIndex(x=>x.id_===ob.id_);-1==indx||"switch"==ob.type||"checkbox"!=sendBack_emsFormBuilder_pub[indx].type&&"payCheckbox"!=sendBack_emsFormBuilder_pub[indx].type&&"multiselect"!=sendBack_emsFormBuilder_pub[indx].type&&"payMultiselect"!=sendBack_emsFormBuilder_pub[indx].type&&"chlCheckBox"!=sendBack_emsFormBuilder_pub[indx].type?-1!=indx&&"@file@"==ob.value?sendBack_emsFormBuilder_pub[indx]=ob:"r_matrix"==ob.type?-1==(indx=sendBack_emsFormBuilder_pub.findIndex(x=>x.id_ob===ob.id_ob))?sendBack_emsFormBuilder_pub.push(ob):sendBack_emsFormBuilder_pub[indx]=ob:-1==indx?sendBack_emsFormBuilder_pub.push(ob):"string"!=typeof ob.price?sendBack_emsFormBuilder_pub[indx].value=ob.value:(sendBack_emsFormBuilder_pub[indx].value=ob.value,sendBack_emsFormBuilder_pub[indx].price=ob.price):-1==(indx=sendBack_emsFormBuilder_pub.findIndex(x=>x.id_===ob.id_&&x.value==ob.value))?sendBack_emsFormBuilder_pub.push(ob):sendBack_emsFormBuilder_pub.splice(indx,1)}else sendBack_emsFormBuilder_pub.push(ob);localStorage.setItem("sendback",JSON.stringify(sendBack_emsFormBuilder_pub)),localStorage.setItem("formId",efb_var.id)}}function alarm_emsFormBuilder(val){return`<div class="efb alert alert-warning alert-dismissible fade show " role="alert" id="alarm_emsFormBuilder">
      <div><i class="efb nmsgefb bi-exclamation-triangle-fill text-center"></i></div>
      <strong>${ajax_object_efm.text.alert} </strong>${val}
    </div>`}function endMessage_emsFormBuilder_view(){const btn_prev=valj_efb[0].hasOwnProperty("logic")&&1==valj_efb[0].logic?"logic_fun_prev_send()":"fun_prev_send()";var el,stepMax=currentTab_emsFormBuilder+1,notfilled=[];for(let i=1;i<=stepMax;i++)-1==sendBack_emsFormBuilder_pub.findIndex(x=>x.step==i)&&notfilled.push(i);const corner=valj_efb[0].hasOwnProperty("corner")?valj_efb[0].corner:"efb-square";let countRequired=0,valueExistsRequired=0;for(el of exportView_emsFormBuilder)if(1==el.required){const id=el.id_;countRequired+=1,-1==sendBack_emsFormBuilder_pub.findIndex(x=>x.id_==id)&&(valueExistsRequired+=1)}if(document.getElementById("body_efb")&&document.getElementById("body_efb").scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),countRequired!=valueExistsRequired&&sendBack_emsFormBuilder_pub.length<1)currentTab_emsFormBuilder=0,document.getElementById("efb-final-step").innerHTML=`<h1 class='efb emsFormBuilder'><i class="efb nmsgefb bi-exclamation-triangle-fill text-center"></i></h1><h3>${ajax_object_efm.text.error}</h3> <span class="efb mb-2">${ajax_object_efm.text.pleaseMakeSureAllFields}</span>
    <div class="efb m-1"> <button id="prev_efb_send" type="button" class="efb btn efb ${valj_efb[0].button_color}   ${corner}   ${valj_efb[0].el_height}  p-2 text-center  btn-lg " onClick="${btn_prev}"><i class="efb  ${valj_efb[0].button_Previous_icon} ${valj_efb[0].button_Previous_icon} ${valj_efb[0].icon_color} mx-2 fs-6 " id="button_group_Previous_icon"></i><span id="button_group_Previous_button_text" class="efb  ${valj_efb[0].el_text_color} ">${valj_efb[0].button_Previous_text}</span></button></div></div>`;else{let checkFile=0;for(var file of files_emsFormBuilder)if(0<files_emsFormBuilder.length&&1==file.state)checkFile+=1;else if(0<files_emsFormBuilder.length&&3==file.state)return checkFile=-100,void(document.getElementById("efb-final-step").innerHTML=`<h3 class='efb emsFormBuilder'><i class="efb nmsgefb bi-exclamation-triangle-fill text-center"></i></h1><h3 class="efb font-weight-bold">File Error</h3> <span class="efb font-weight-bold">${ajax_object_efm.text.youNotPermissionUploadFile}</br>${file.url}</span>
         <div class="efb m-1"> <button id="prev_efb_send" type="button" class="efb btn efb ${valj_efb[0].button_color}   ${corner}   ${valj_efb[0].el_height}  p-2 text-center  btn-lg  " onClick="${btn_prev}"><i class="efb  ${valj_efb[0].button_Previous_icon} ${valj_efb[0].button_Previous_icon} ${valj_efb[0].icon_color} mx-2 fs-6 " id="button_group_Previous_icon"></i><span id="button_group_Previous_button_text" class="efb  ${valj_efb[0].el_text_color} ">${valj_efb[0].button_Previous_text}</span></button></div></div>`);if(0==checkFile){if(0<files_emsFormBuilder.length)for(const file of files_emsFormBuilder)-1==sendBack_emsFormBuilder_pub.findIndex(x=>x.id_==file.id_)&&(sendBack_emsFormBuilder_pub.push(file),localStorage.setItem("sendback",JSON.stringify(sendBack_emsFormBuilder_pub)));1==validation_before_send_emsFormBuilder()&&actionSendData_emsFormBuilder()}else{const timeValue=setInterval(function(){let checkFile=0;for(var file of files_emsFormBuilder)if(0<files_emsFormBuilder.length&&1==file.state)checkFile+=1;else if(0<files_emsFormBuilder.length&&3==file.state)return checkFile=-100,void(document.getElementById("efb-final-step").innerHTML=`<h3 class='efb emsFormBuilder'><i class="efb nmsgefb bi-exclamation-triangle-fill text-center"></i></h1><h3 class="efb fs-4">File Error</h3> <span class="efb fs-6">${ajax_object_efm.text.youNotPermissionUploadFile}</br>${file.url}</span>
               <div class="efb m-1"> <button id="prev_efb_send" type="button" class="efb btn efb ${valj_efb[0].button_color}   ${corner}   ${valj_efb[0].el_height}  p-2 text-center  btn-lg  " onClick="${btn_prev}"><i class="efb  ${valj_efb[0].button_Previous_icon} ${valj_efb[0].button_Previous_icon} ${valj_efb[0].icon_color} mx-2 fs-6 " id="button_group_Previous_icon"></i><span id="button_group_Previous_button_text" class="efb  ${valj_efb[0].el_text_color} ">${valj_efb[0].button_Previous_text}</span></button></div></div>`);if(0==checkFile){for(const file of files_emsFormBuilder)sendBack_emsFormBuilder_pub.push(file),localStorage.setItem("sendback",JSON.stringify(sendBack_emsFormBuilder_pub));1==validation_before_send_emsFormBuilder()&&actionSendData_emsFormBuilder(),clearInterval(timeValue)}},1500)}}}function actionSendData_emsFormBuilder(){if("userIsLogin"==ajax_object_efm.type)return 0;if("login"!=form_type_emsFormBuilder&&localStorage.setItem("sendback",JSON.stringify(sendBack_emsFormBuilder_pub)),recaptcha_emsFormBuilder=1<valueJson_ws.length&&1==valueJson_ws[0].hasOwnProperty("captcha")&&1==valueJson_ws[0].captcha&&"object"==typeof grecaptcha?grecaptcha.getResponse():"",navigator.onLine){form_type_emsFormBuilder=2<typeof valj_efb.length?valj_efb[0].type:form_type_emsFormBuilder;let data={action:"get_form_Emsfb",value:JSON.stringify(sendBack_emsFormBuilder_pub),name:formNameEfb,id:efb_var.id,valid:recaptcha_emsFormBuilder,type:form_type_emsFormBuilder,url:location.href.split("?")[0],sid:efb_var.sid};0<valj_efb.length&&valj_efb[0].hasOwnProperty("type")&&"payment"==valj_efb[0].type&&("persiaPay"==valj_efb[0].getway?data={action:"get_form_Emsfb",value:JSON.stringify(sendBack_emsFormBuilder_pub),name:formNameEfb,payid:sessionStorage.getItem("payId"),id:sessionStorage.getItem("id"),valid:recaptcha_emsFormBuilder,type:form_type_emsFormBuilder,payment:"persiaPay",auth:get_authority_efb,url:location.href.split("?")[0],sid:efb_var.sid}:"stripe"==valj_efb[0].getway&&(data={action:"get_form_Emsfb",value:JSON.stringify(sendBack_emsFormBuilder_pub),name:formNameEfb,id:efb_var.id,payid:efb_var.payId,valid:recaptcha_emsFormBuilder,type:form_type_emsFormBuilder,payment:"stripe",url:location.href.split("?")[0],sid:efb_var.sid})),post_api_forms_efb(data)}else response_fill_form_efb({success:!1,data:{success:!1,m:ajax_object_efm.text.offlineMSend}})}function valid_email_emsFormBuilder(el){var offsetw=document.getElementById("body_efb").offsetWidth,msg=Number(offsetw)<380&&0==window.matchMedia("(max-width: 480px)").matches?`<div class="efb fs-5 nmsgefb bi-exclamation-diamond-fill" onClick="alert_message_efb('${ajax_object_efm.text.enterTheEmail}','',10,'danger');"></div>`:ajax_object_efm.text.enterTheEmail,check=0,format=/^[\w-\.]+@([\w-]+\.)+[\w-]{2,4}$/;return 0<(check+=el.value.match(format)?0:1)?(el.value.match(format)||(el.className=colorBorderChangerEfb(el.className,"border-danger")),Number(offsetw)<525&&0==window.matchMedia("(max-width: 480px)").matches&&document.getElementById(el.id+"-message").classList.add("unpx"),document.getElementById(el.id+"-message").innerHTML=msg,document.getElementById(el.id+"-message").classList.contains("show")&&document.getElementById(el.id+"-message").classList.add("show"),-1!=(format=sendBack_emsFormBuilder_pub.findIndex(x=>x.id_==el.dataset.vid))&&sendBack_emsFormBuilder_pub.splice(format,1)):(el.className=colorBorderChangerEfb(el.className,"border-success"),document.getElementById(el.id+"-message").classList.remove("show"),document.getElementById(el.id+"-message").innerHTML=""),!(0<check)}function valid_password_emsFormBuilder(el){var i,id=el.id,offsetw=document.getElementById("body_efb").offsetWidth,msg=Number(offsetw)<380&&0==window.matchMedia("(max-width: 480px)").matches?`<div class="efb fs-5 nmsgefb bi-exclamation-diamond-fill" onClick="alert_message_efb('${ajax_object_efm.text.enterThePassword}','',10,'danger');"></div>`:efb_var.text.enterThePassword;return el.value.length<3?(el.className=colorBorderChangerEfb(el.className,"border-danger"),-1!=(i=sendBack_emsFormBuilder_pub.findIndex(x=>x.id_==el.dataset.vid))&&sendBack_emsFormBuilder_pub.splice(i,1),Number(offsetw)<525&&0==window.matchMedia("(max-width: 480px)").matches&&document.getElementById(id+"-message").classList.add("unpx"),document.getElementById(id+"-message").innerHTML=msg,document.getElementById(el.id+"-message").classList.contains("show")&&document.getElementById(el.id+"-message").classList.add("show"),!1):(el.className=colorBorderChangerEfb(el.className,"border-success"),document.getElementById(id+"-message").innerHTML="",document.getElementById(id+"-message").classList.remove("show"),!0)}function valid_phone_emsFormBuilder(el){var offsetw=document.getElementById("body_efb").offsetWidth,msg=Number(offsetw)<380&&0==window.matchMedia("(max-width: 480px)").matches?`<div class="efb fs-5 nmsgefb bi-exclamation-diamond-fill" onClick="alert_message_efb('${ajax_object_efm.text.enterThePhones}','',10,'danger');"></div>`:ajax_object_efm.text.enterThePhones,check=0,format=/^\s*(?:\+?(\d{1,3}))?([-. (]*(\d{3})[-. )]*)?((\d{3})[-. ]*(\d{2,4})(?:[-.x ]*(\d+))?)\s*$/gm,id=el.id;return 0<(check+=el.value.match(format)?0:1)?(el.value.match(format)||(el.className=colorBorderChangerEfb(el.className,"border-danger")),-1!=(format=sendBack_emsFormBuilder_pub.findIndex(x=>x.id_==el.dataset.vid))&&sendBack_emsFormBuilder_pub.splice(format,1),Number(offsetw)<525&&0==window.matchMedia("(max-width: 480px)").matches&&document.getElementById(el.id+"-message").classList.add("unpx"),document.getElementById(id+"-message").innerHTML=msg,document.getElementById(el.id+"-message").classList.contains("show")&&document.getElementById(el.id+"-message").classList.add("show")):(el.className=colorBorderChangerEfb(el.className,"border-success"),document.getElementById(id+"-message").innerHTML="",document.getElementById(id+"-message").classList.remove("show")),!(0<check)}function valid_file_emsFormBuilder(id,tp){var msgEl=document.getElementById(id+"_-message");msgEl.innerHTML="",msgEl.classList.remove("show"),document.getElementById(id+"_").classList.remove("border-danger");let file="";var f=valueJson_ws.find(x=>x.id_===id);file=f.file&&3<f.file.length?f.file:"Zip";let check=0,rtrn=!1;let message="";var filetype,f=document.getElementById(id+"_");return f.files[0]&&f.files[0].size<fileSizeLimite_emsFormBuilder&&(filetype=1<f.files[0].type.length?f.files[0].type:f.files[0].name.slice(-1*(f.files[0].name.lastIndexOf(".")-1)),1==validExtensions_efb_fun(file,filetype))&&(check=1,message=ajax_object_efm.text.pleaseUploadA+" "+ajax_object_efm.text[file]),rtrn=0<check?(msgEl.innerHTML="",fun_upload_file_api_emsFormBuilder(id,file,tp),!0):(f.files[0]&&message.length<2&&(message=f.files[0].size<fileSizeLimite_emsFormBuilder?ajax_object_efm.text.pleaseUploadA+" "+ajax_object_efm.text[file]:ajax_object_efm.text.fileSizeIsTooLarge),0!=(filetype=colorTextChangerEfb(msgEl.className,"text-danger"))&&(msgEl.className=filetype),msgEl.innerHTML=message,msgEl.classList.contains("show")||msgEl.classList.add("show"),!1)}function fun_tracking_show_emsFormBuilder(){var time=1==pro_efb?10:2100,getUrlparams=new URLSearchParams(location.search);efb_var.user_type=location.href.includes("user=admin")?"admin":"user";let get_track=null!=getUrlparams.get("track")?sanitize_text_efb(getUrlparams.get("track")):null;get_track?(get_track=`value="${get_track}"`,change_url_back_persia_pay_efb()):get_track="",setTimeout(()=>{document.getElementById("body_tracker_emsFormBuilder").innerHTML=` 
  <div class="efb  ${1==ajax_object_efm.rtl?"rtl-text":""}" >
                <div class="efb row mb-3 pb-3 px-1" id="body_efb-track">
                    <h4 class="efb  title-holder  col-12 mt-4 fs-3"><i class="efb  bi-check2-square title-icon mx-1 fs-3"></i> ${ajax_object_efm.text.pleaseEnterTheTracking}</h4>
                <div class="efb  row col-md-12">
                        <label for="trackingCodeEfb" class="efb fs-6 form-label mx-2 col-12">
                        ${ajax_object_efm.text.trackingCode}:<span class="efb fs-8 text-danger mx-1">*</span></label>
                        <div class="efb  col-12 text-center mx-2 row">
                        <input type="text" class="efb input-efb form-control border-d efb-rounded text-labelEfb h-l-efb mb-2" placeholder="${ajax_object_efm.text.entrTrkngNo}" id="trackingCodeEfb" ${get_track}>
                         <!-- recaptcha  -->
                         ${1==setting_emsFormBuilder.scaptcha?`<div class="efb  row mx-3"><div id="gRecaptcha" class="efb g-recaptcha my-2 mx-2" data-sitekey="${setting_emsFormBuilder.siteKey}" data-callback="verifyCaptcha"></div><small class="efb text-danger" id="recaptcha-message"></small></div>`:""}
                         
                         <!-- recaptcha end  -->
                         <button type="submit" class="efb fs-5  btn btn-pinkEfb col-12 text-white mb-1 "  id="vaid_check_emsFormBuilder" onclick="fun_vaid_tracker_check_emsFormBuilder()">
                        <i class="efb fs-5  bi-search"></i> ${ajax_object_efm.text.search}  </button>
                        </div>
                    </div>
                </div>
                
            <!-- efb -->            
        </div>
        <div id="alert_efb" class="efb mx-5"></div>
`,1==setting_emsFormBuilder.scaptcha&&(sitekye_emsFormBuilder=setting_emsFormBuilder.siteKey,loadCaptcha_efb())},time)}function fun_get_tracking_code(){}function fun_vaid_tracker_check_emsFormBuilder(){var innrBtn,response;navigator.onLine?(innrBtn=document.getElementById("vaid_check_emsFormBuilder").innerHTML,document.getElementById("vaid_check_emsFormBuilder").innerHTML='<i class="efb  bi-hourglass-split"></i>',document.getElementById("vaid_check_emsFormBuilder").classList.toggle("disabled"),(el=document.getElementById("trackingCodeEfb").value).length<5?(document.getElementById("vaid_check_emsFormBuilder").innerHTML=innrBtn,document.getElementById("vaid_check_emsFormBuilder").classList.toggle("disabled"),noti_message_efb(ajax_object_efm.text.trackingCodeIsNotValid,"danger","body_efb-track")):0==currentTab_emsFormBuilder&&(null==(response=sitekye_emsFormBuilder?grecaptcha.getResponse()||null:"not")?(document.getElementById("vaid_check_emsFormBuilder").innerHTML=innrBtn,document.getElementById("vaid_check_emsFormBuilder").classList.toggle("disabled"),noti_message_efb(ajax_object_efm.text.checkedBoxIANotRobot,"danger","body_efb-track")):(data={action:"get_track_Emsfb",value:el,name:formNameEfb,valid:recaptcha_emsFormBuilder,nonce:ajax_object_efm.nonce,sid:efb_var.sid},recaptcha_emsFormBuilder=response,post_api_tracker_check_efb(data,innrBtn)))):noti_message_efb(efb_var.text.offlineSend,"danger","body_efb-track")}function emsFormBuilder_show_content_message(value,content){var c,msg_id=value.msg_id,track=value.track,date=value.date;const val=JSON.parse(replaceContentMessageEfb(value.content));let m=fun_emsFormBuilder_show_messages(val,"user",track,date);for(c of content){const val=JSON.parse(c.content.replace(/[\\]/g,""));m+=`<div class="efb   mb-3"><div class="efb  clearfix"> ${fun_emsFormBuilder_show_messages(val,c.rsp_by,track,c.date)}</div></div>`}value=`<div class="efb mx-2 mt-2"><div class="efb form-group mb-3" id="replay_section__emsFormBuilder">
  <label for="replayM_emsFormBuilder" class:'efb mx-1 fs-7" id="label_replyM_efb">${ajax_object_efm.text.reply}:</label>
  <textarea class="efb form-control border-d fs-6" id="replayM_emsFormBuilder" rows="5" data-id="${msg_id}"></textarea>
  
  </div>
  <div class="efb col text-right row my-2 mx-1">
  <button type="submit" class="efb btn fs-5 btn-r btn-primary btn-lg" id="replayB_emsFormBuilder" OnClick="fun_send_replayMessage_emsFormBuilder(${msg_id})">${ajax_object_efm.text.reply} </button>
  <!-- recaptcha  -->
  ${sitekye_emsFormBuilder?`<div class="efb row mx-3"><div class="efb g-recaptcha my-2 mx-2" data-sitekey="${sitekye_emsFormBuilder}" id="recaptcha"></div><small class="efb text-danger" id="recaptcha-message"></small></div>`:""}
  <!-- recaptcha end  -->
  <p class="efb mx-2 my-1 text-pinkEfb efb fs-7" id="replay_state__emsFormBuilder">  </p>
  </div></div>
  `;return`
  <div class="efb modal-header efb">
  <h5 class="efb modal-title fs-5"><i class="efb  bi-chat-square-text mx-2 mx-2"></i>
   <span id="settingModalEfb-title">${ajax_object_efm.text.response}</span></h5>
 </div>
  <div class="efb modal-body overflow-auto py-0 my-0  ${1==efb_var.rtl?"rtl-text":""}" id="resp_efb">
    ${m} 
   </div>
   ${value}
   </div>
   </div>
</div>
<div>
</div></div>`}function fun_emsFormBuilder_show_messages(content,by,track,date){stock_state_efb=!1,"w_link"==content[content.length-1].type&&content.pop();var dl=setting_emsFormBuilder.hasOwnProperty("activeDlBtn")&&1==setting_emsFormBuilder.activeDlBtn?`<div class="efb col fs-4 h-d-efb pointer-efb text-darkb d-flex justify-content-end bi-download" data-toggle="tooltip" data-placement="bottom" title="${efb_var.text.download}" onClick="generatePDF_EFB('resp_efb')"></div>`:"";1==by?by="Admin":0!=by&&0!=by.length&&-1!=by.length||(by="visitor");let m=`<Div class="efb bg-response efb card-body my-2 py-2 ${1==efb_var.rtl?"rtl-text":""}">
  <div class="efb  form-check">
  <div>
      <p class="efb small fs-7 mb-0"><span>${ajax_object_efm.text.by}:</span> ${by}</p>
    ${0!=track?`<p class="efb small fs-7 mb-0"><span> ${ajax_object_efm.text.trackingCode}:</span> ${track} </p>`:""}
    <p class="efb small fs-7 mb-0"><span>${ajax_object_efm.text.ddate}:</span> ${date} </p>  
  </div>
    ${dl}
  </div>
 <hr>
 `;content.sort((a,b)=>Number(a.amount)>Number(b.amount)?1:-1);var list=[],checboxs=[],currency=content[0].hasOwnProperty("paymentcurrency")?content[0].paymentcurrency:"usd";for(const c of content){let value="<b></b>";if(c.hasOwnProperty("value")&&"maps"!=c.type&&(c.value=replaceContentMessageEfb(c.value),c.hasOwnProperty("qty")&&(c.qty=replaceContentMessageEfb(c.qty)),value=`<b>${c.value.toString().replaceAll("@efb!",",")}</b>`,0!=c.hasOwnProperty("qty"))&&(value+=`: <b> ${c.qty}</b>`),s=!1,"@file@"==c.value&&-1==list.findIndex(x=>x==c.url)){s=!0,list.push(c.url);c.url.slice(c.url.lastIndexOf("/")+1,c.url.lastIndexOf("."));if("Image"==c.type||"image"==c.type)value=`</br><img src="${c.url}" alt="${c.name}" class="efb img-thumbnail m-1">`;else if("Document"==c.type||"document"==c.type||"allformat"==c.type)value=`</br><a class="efb btn btn-primary m-1" href="${c.url}" target="_blank" >${ajax_object_efm.text.download}</a>`;else if("Media"==c.type||"media"==c.type){let media="video";["mp3","wav","ogg"].forEach(function(aud){-1!==c.url.indexOf(aud)&&(media="audio")}),value="video"==media?(len=c.url.length,"avi"!==(len=c.url.slice(len-c.url.lastIndexOf(x=>"."==x),len))?`</br><div class="efb px-1"><video poster="${poster_emsFormBuilder}" src="${c.url}" type='video/${len}'controls></video></div><p class="efb text-center" ><a href="${c.url}">${efb_var.text.videoDownloadLink}</a></p>`:`<p class="efb text-center"><a href="${c.url}">${efb_var.text.downloadViedo}</a></p>`):`<div ><audio controls><source src="${c.url}"></audio> </div>`}else value=1<c.url.length?`</br><a class="efb btn btn-primary" href="${c.url}" target="_blank" >${c.name}</a>`:'<span class="efb  fs-5">💤</span>'}else if("esign"==c.type){var len=c.hasOwnProperty("name")?c.name.toLowerCase():"",len=efb_var.text[len]||c.name;s=!0,value=`<img src="${c.value}" alt="${c.name}" class="efb img-thumbnail">`,m+=`<p class="efb fs-6 my-0 efb  form-check">${len}:</p> <p class="efb my-1 mx-3 fs-7 form-check"><br> ${value}</p>`}else if("color"==c.type){let title=c.hasOwnProperty("name")?c.name.toLowerCase():"";title=efb_var.text[title]||c.name,s=!0,value=`<div class="efb img-thumbnail"  style="background-color:${c.value}; height: 50px;">${c.value}</div>`,m+=`<p class="efb fs-6 my-0 efb  form-check">${title}:</p> <p class="efb my-1 mx-3 fs-7 form-check"><br> ${value}</p>`}else if("maps"==c.type)"object"==typeof c.value&&(s=!0,value=`<div id="${c.id_}-map" data-type="maps" class="efb  maps-efb h-d-efb  required " data-id="${c.id_}-el" data-name="maps"><h1>maps</h1></div>`,valj_efb.push({id_:c.id_,mark:-1,lat:c.value[0].lat,lng:c.value[0].lng,zoom:9,type:"maps"}),marker_maps_efb=c.value,initMap(!1),m+=value);else if("rating"==c.type){s=!0;let title=c.hasOwnProperty("name")?c.name.toLowerCase():"";title=efb_var.text[title]||c.name,value=`<div class='efb fs-4 star-checked star-efb mx-1 ${1==efb_var.rtl?"text-end":"text-start"}'>`;for(let i=0;i<parseInt(c.value);i++)value+='<i class="efb bi bi-star-fill"></i>';value+="</div>",m+=`<p class="efb fs-6 my-0 efb  form-check">${title}:</p> <p class="efb my-1 mx-3 fs-7 form-check">${value}</p>`}else if("checkbox"==c.type&&0==checboxs.includes(c.id_)){s=!0;let vc="null";checboxs.push(c.id_);for(var op of content)"checkbox"==op.type&&op.id_==c.id_&&("null"==vc?vc=`<p class="efb my-1 mx-3 fs-7 form-check"><b> ${op.value}</b></p>`:vc+=`<p class="efb my-1 mx-3 fs-7 form-check"><b> ${op.value}</b></p>`);m+=`<p class="efb fs-6 my-0 efb">${c.name}:</p>`+vc}if("passwordRegisterEFB"==c.id_&&(m+=value,value="**********"),(1==s&&"@file@"==c.value||0==s&&"@file@"!=c.value)&&"payment"!=c.id_&&"checkbox"!=c.type){let title=c.hasOwnProperty("name")?c.name.toLowerCase():"title",q=("file"==title&&(title="atcfle"),title=efb_var.text[title]||c.name,"<b>@file@</b>"!==value?value:"");c.type.includes("pay")&&"payment"!=c.id_?q+=`<span class="efb col fw-bold  text-labelEfb h-d-efb hStyleOpEfb d-flex justify-content-end">${Number(c.price).toLocaleString(lan_name_emsFormBuilder,{style:"currency",currency:currency})}</span>`:c.type.includes("imgRadio")&&(q='<div class="efb w-25">'+fun_imgRadio_efb(c.id_,c.src,c)+"</div>"),m+=`<p class="efb fs-6 my-0 efb">${title}:</p><p class="efb my-1 mx-3 fs-7 test form-check">${q}</p>`}"payment"==c.type?"stripe"==c.paymentGateway?m+=`<div class="efb mx-3 fs7 bg-dark text-white text-capitalize  p-2 my-1">
        <p class="efb fs-6 my-0">${efb_var.text.payment} ${efb_var.text.id}:<span class="efb mb-1"> ${c.paymentIntent}</span></p>
            <p class="efb  my-0">${efb_var.text.payAmount}:<span class="efb mb-1"> ${Number(c.total).toLocaleString(lan_name_emsFormBuilder,{style:"currency",currency:currency})}</span></p>
            <p class="efb my-0">${efb_var.text.ddate}:<span class="efb mb-1"> ${c.paymentCreated}</span></p>
            <p class="efb my-0">${efb_var.text.updated}:<span class="efb mb-1"> ${c.updatetime}</span></p>
            <p class="efb  my-0">${efb_var.text.methodPayment}:<span class="efb mb-1"> ${c.paymentmethod}</span></p>
            ${"charge"!=c.paymentmethod?`<p class="efb fs-6 my-0">${efb_var.text.interval}:<span class="efb mb-1 text-capitalize"> ${c.interval}</span></p>`:""}
            </div>`:m+=`<div class="efb mx-3 fs7 bg-dark text-white text-capitalize p-2 my-1">
            <p class="efb fs-6 my-0">${efb_var.text.payment} ${efb_var.text.id}:<span class="efb mb-1"> ${c.paymentIntent}</span></p>
            <p class="efb my-0">${efb_var.text.payAmount}:<span class="efb mb-1"> ${c.total} ریال</span></p>
            <p class="efb  my-0">${efb_var.text.methodPayment}:<span class="efb mb-1"> ${c.paymentmethod}</span></p>
            <p class="efb my-0">${efb_var.text.ddate}:<span class="efb mb-1"> ${c.paymentCreated}</span></p>
           <!-- <p class="efb my-0">شماره کارت:<span class="efb mb-1"> ${c.paymentCard}</span></p>
            <p class="efb my-0">کد پیگیری زرین پال<span class="efb mb-1"> ${c.refId}</span></p> -->
            </div>`:"closed"==c.type?stock_state_efb=!0:"opened"==c.type&&(stock_state_efb=!1)}return m+="</div>"}function fun_send_replayMessage_emsFormBuilder(id){document.getElementById("replayB_emsFormBuilder").classList.add("disabled"),document.getElementById("replayB_emsFormBuilder").innerHTML='<i class="efb bi-hourglass-split mx-1"></i>'+efb_var.text.sending,setTimeout(()=>{var message=document.getElementById("replayM_emsFormBuilder").value.replace(/\n/g,"@efb@nq#");if(fun_sendBack_emsFormBuilder([{id_:"message",name:"message",type:"text",amount:0,value:message=sanitize_text_efb(message),by:1<ajax_object_efm.user_name.length?ajax_object_efm.user_name:efb_var.text.guest,session:sessionPub_emsFormBuilder}][0]),message.length<1)check_msg_ext_resp_efb(),document.getElementById("replay_state__emsFormBuilder").innerHTML=`<h6 class="efb fs-6"><i class="efb bi-exclamation-triangle-fill nmsgefb"></i>${efb_var.text.error}${efb_var.text.pleaseEnterVaildValue}</h6>`;else{if(1==setting_emsFormBuilder.hasOwnProperty("dsupfile")&&1!=setting_emsFormBuilder.dsupfile)for(const s in sendBack_emsFormBuilder_pub)"file"==sendBack_emsFormBuilder_pub[s].name&&sendBack_emsFormBuilder_pub.splice(s,1);fun_send_replayMessage_reast_emsFormBuilder(sendBack_emsFormBuilder_pub)}},100)}function fun_send_replayMessage_reast_emsFormBuilder(message){navigator.onLine?(f_btn=()=>{document.getElementById("replay_state__emsFormBuilder").innerHTML=efb_var.text.enterYourMessage,document.getElementById("replayM_emsFormBuilder").innerHTML="",document.getElementById("replayB_emsFormBuilder").classList.remove("disabled")},message.length<1?f_btn():(data={action:"set_rMessage_id_Emsfb",type:"POST",id:efb_var.msg_id,valid:recaptcha_emsFormBuilder,message:JSON.stringify(message),type:form_type_emsFormBuilder,sid:efb_var.sid,user_type:efb_var.user_type},post_api_r_message_efb(data,message))):noti_message_efb(efb_var.text.offlineSend,"danger","replay_state__emsFormBuilder")}function fun_emsFormBuilder__add_a_response_to_messages(message,by,userIp,track,date){message=`<div class="efb   mb-3"><div class="efb  clearfix">${fun_emsFormBuilder_show_messages(message,by,track,date)}</div></div>`;document.getElementById("resp_efb").innerHTML+=message}function fun_show_alert_setting_emsFormBuilder(){var m=`<div class="efb alert alert-danger" role="alert"> <h2 class="efb font-weight-bold">
            ${ajax_object_efm.text.error}</br>
            ${ajax_object_efm.text.formIsNotShown}</br>
            <a href="https://www.youtube.com/embed/a1jbMqunzkQ"  target="_blank" class="efb font-weight-normal">${ajax_object_efm.text.pleaseWatchTutorial}</a> </h2> </div>`;document.getElementById("body_emsFormBuilder")?document.getElementById("body_emsFormBuilder").innerHTML=m:document.getElementById("body_tracker_emsFormBuilder")?document.getElementById("body_tracker_emsFormBuilder").innerHTML=m:window.alert(ajax_object_efm.text.error+" "+ajax_object_efm.text.formIsNotShown)}function validation_before_send_emsFormBuilder(){var btn_prev=valj_efb[0].hasOwnProperty("logic")&&1==valj_efb[0].logic?"logic_fun_prev_send()":"fun_prev_send()",count=[0,0];let fill=0,require=0;for(const v of valueJson_ws)require+=1==v.required&&"file"!==v.type?1:0,"file"==v.type&&null==document.getElementById(v.id_+"_").files[0]&&1==v.required&&--fill;for(const row of sendBack_emsFormBuilder_pub)if(count[0]+=1,"@file@"==row.value){const indx=valueJson_ws.findIndex(x=>x.id_==row.id_);-1!=indx&&(valueJson_ws[indx].hasOwnProperty("disabled")&&1==valueJson_ws[indx].disabled&&(valueJson_ws[indx].hasOwnProperty("hidden")&&0==valueJson_ws[indx].hidden||0==valueJson_ws[indx].hasOwnProperty("hidden"))?(i=sendBack_emsFormBuilder_pub.findIndex(x=>x.id_==valueJson_ws[indx].id_),sendBack_emsFormBuilder_pub.splice(i,1),--count[0]):5<row.url.length&&(fill+=1==valueJson_ws[indx].required?1:0,count[1]+=1))}else if("@file@"!=row.type&&"payment"!=row.type){const indx=valueJson_ws.findIndex(x=>x.id_==row.id_);if(-1!=indx){if("multiselect"==valueJson_ws[indx].type||"option"==valueJson_ws[indx].type||"Select"==valueJson_ws[indx].type||"payMultiselect"==valueJson_ws[indx].type||"paySelect"==valueJson_ws[indx].type){var i="multiselect"==valueJson_ws[indx].type||"payMultiselect"==valueJson_ws[indx].type?valueJson_ws.findIndex(x=>x.parent==valueJson_ws[indx].id_):valueJson_ws.findIndex(x=>x.parents==valueJson_ws[indx].id_);fill+=1==valueJson_ws[indx].required&&-1<i?1:0}else if("chlCheckBox"==valueJson_ws[indx].type){const exists=valueJson_ws.findIndex(x=>x.parents==valueJson_ws[indx].id_);fill+=1==valueJson_ws[indx].required&&-1<exists?1:0}else fill+=1==valueJson_ws[indx].required?1:0;0<row.value.length&&(count[1]+=1)}}else 0<row.value.length&&(count[1]+=1);if(require=require>fill?1:0,!(0==count[1]&&0!=count[0]||0==count[0]&&0==count[1]||1==require)||1!=valj_efb[0].hasOwnProperty("logic")&&0!=valj_efb[0].hasOwnProperty("logic")||0!=valj_efb.logic)return!0;document.getElementById("efb-final-step").innerHTML=`<h3 class='efb emsFormBuilder'><i class="efb nmsgefb bi-exclamation-triangle-fill text-center fs-2 efb"></i></h1><h3 class="efb fs-3 efb text-muted">${ajax_object_efm.text.error}</h3> <span class="efb mb-2 fs-5 efb text-muted"> ${1!=require?ajax_object_efm.text.PleaseFillForm:ajax_object_efm.text.pleaseFillInRequiredFields} </br></span>
     <div class="efb m-1"> <button id="prev_efb_send" type="button" class="efb btn efb ${valj_efb[0].button_color}   ${valj_efb[0].hasOwnProperty("corner")?valj_efb[0].corner:"efb-square"}   ${valj_efb[0].el_height}  p-2 text-center  btn-lg  " onClick="${btn_prev}"><i class="efb  ${valj_efb[0].button_Previous_icon} ${valj_efb[0].button_Previous_icon} ${valj_efb[0].icon_color} mx-2 fs-6 " id="button_group_Previous_icon"></i><span id="button_group_Previous_button_text" class="efb  ${valj_efb[0].el_text_color} ">${valj_efb[0].button_Previous_text}</span></button></div></div>`,document.getElementById("body_efb")&&document.getElementById("body_efb").scrollIntoView({behavior:"smooth",block:"center",inline:"center"});for(const v of valueJson_ws)if("file"!=v.type&&"dadfile"!=v.type&&"checkbox"!=v.type&&"radiobutton"!=v.type&&"option"!=v.type&&"multiselect"!=v.type&&"select"!=v.type&&"payMultiselect"!=v.type&&"paySelect"!=v.type&&"payRadio"!=v.type&&"payCheckbox"!=v.type&&"chlCheckBox"!=v.type)return v.id_&&document.getElementById(v.id_).value.length<5&&(document.getElementById(v.id_+"-message").innerHTML=ajax_object_efm.text.enterTheValueThisField),!1}function show_user_profile_emsFormBuilder(ob){return`<div class="efb mt-5"><div class="efb card-block text-center text-dark ">
              <div class="efb mb-3 d-flex justify-content-center"> <img src="${ob.user_image}" class="efb userProfileImageEFB" alt="${ob.display_name}"> </div>
              <h6 class="efb  fs-5 mb-1 d-flex justify-content-center text-dark">${ob.display_name}</h6> <p class="efb  fs-6">${ob.user_login}</p>                          
              <button type="button"  class="efb btn fs-5 btn-lg btn-danger efb mt-1 " onclick="emsFormBuilder_logout()">${ajax_object_efm.text.logout}</button>
          </div> </div>`}function emsFormBuilder_logout(){document.getElementById("body_efb").innerHTML=loading_messge_efb(),form_type_emsFormBuilder="logout",formNameEfb="logout",ajax_object_efm.type="logout",sendBack_emsFormBuilder_pub={logout:!0},recaptcha_emsFormBuilder="",actionSendData_emsFormBuilder()}function Show_recovery_pass_efb(){let el=document.getElementById("recoverySectionemsFormBuilder");if(el.style.display="none"==el.style.display?"block":"none",document.getElementById("recoverySectionemsFormBuilder").scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),(el=document.getElementById("btn_recovery_pass_efb")).disabled=!0,1==el.dataset.id){el.dataset.id=0;const us=document.getElementById("username_recovery_pass_efb"),format=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;el.addEventListener("click",e=>{form_type_emsFormBuilder="recovery",formNameEfb=form_type_emsFormBuilder,sendBack_emsFormBuilder_pub={email:us.value,recovery:!0},document.getElementById("efb-final-step").innerHTML=`<h1 class="efb fas fa-sync fa-spin text-primary emsFormBuilder"></h1> <h3>${ajax_object_efm.text.pleaseWaiting}<h3>`,actionSendData_emsFormBuilder()}),us.addEventListener("keyup",e=>{0==(us.value.match(format)?0:1)?el.classList.remove("disabled"):1!=el.classList.contains("disabled")&&el.classList.add("disabled")})}}function response_fill_form_efb(res){let btn_prev="";if(1<valj_efb.length&&(btn_prev=valj_efb[0].hasOwnProperty("logic")&&1==valj_efb[0].logic?"logic_fun_prev_send()":"fun_prev_send()"),1==res.data.success)if(null!=res.data.track&&fun_send_mail_emsFormBuilder(res.data.track,res.data.nonce,"msg"),0<valj_efb.length&&1==valj_efb[0].hasOwnProperty("thank_you")&&"rdrct"==valj_efb[0].thank_you)document.getElementById("efb-final-step").innerHTML=`
      <h3 class="efb fs-4">${efb_var.text.sentSuccessfully}</h3>
      <h3 class="efb">${efb_var.text.pWRedirect} <a class="efb text-darkb" href="${res.data.m}">${efb_var.text.orClickHere}</a></h3>
      `,window.location.href=res.data.m;else{switch(form_type_emsFormBuilder){case"form":case"survey":case"payment":document.getElementById("efb-final-step").innerHTML=funTnxEfb(res.data.track),localStorage.clear();break;case"subscribe":document.getElementById("efb-final-step").innerHTML=`<h3 class='efb emsFormBuilder fs-4'><i class="efb fs-2 bi-hand-thumbs-up text-primary""></i></h3><h3 class='efb emsFormBuilder fs-5'>${valj_efb[0].thank_you_message.thankYou}</h3></br> <span class="efb fs-5">${ajax_object_efm.text.YouSubscribed}</span></br></br></h3>`,localStorage.clear();break;case"register":var m="recovery"!=form_type_emsFormBuilder?valj_efb[0].thank_you_message.thankYou:ajax_object_efm.text.checkYourEmail;document.getElementById("efb-final-step").innerHTML=funTnxEfb("","",m);break;case"recovery":document.getElementById("efb-final-step").innerHTML=`<h3 class='efb emsFormBuilder fs-4'><i class="efb fs-2 bi-envelope text-primary""></i></h3><h3 class='efb emsFormBuilder fs-5'>${res.data.m}</h3></br></br></h3>`;break;case"login":1==res.data.m.state?(document.getElementById("body_efb").innerHTML=show_user_profile_emsFormBuilder(res.data.m),location.reload()):document.getElementById("efb-final-step").innerHTML=`<h3 class='efb emsFormBuilder text-center fs-5 efb mb-0 mt-5'><i class="efb fs-2 bi-exclamation-triangle-fill nmsgefb"></i></h3> <span class="efb fs-7"> <br>${res.data.m.error}</span>
           </br>
           <a  id="btn_Show_recovery_efb" class="efb pointer-efb emsFormBuilder " onClick="Show_recovery_pass_efb()" >${ajax_object_efm.text.passwordRecovery} </a>
           <div class="efb py-5 px-2 container bg-light mb-3" id="recoverySectionemsFormBuilder" style="display: none;">     
              <input type="email" id="username_recovery_pass_efb" class="efb px-2 mb-1 emsFormBuilder_v  h-d-efb efb-square col-8" placeholder="Email" >
              <a  id="btn_recovery_pass_efb" class=" efb btn h-d-efb btn-block btn-pinkEfb text-white mb-2 get-emsFormBuilder disabled" data-id="1" >${ajax_object_efm.text.send}</a>
              </div>
              <div class="efb m-1"> <button id="prev_efb_send" type="button" class="efb btn efb ${valj_efb[0].button_color}   ${valj_efb[0].hasOwnProperty("corner")?valj_efb[0].corner:"efb-square"}   ${valj_efb[0].el_height}  p-2 text-center  btn-lg  " onClick="fun_prev_send()"><i class="efb  ${valj_efb[0].button_Previous_icon} ${valj_efb[0].button_Previous_icon} ${valj_efb[0].icon_color} mx-2 fs-6 " id="button_group_Previous_icon"></i><span id="button_group_Previous_button_text" class="efb  ${valj_efb[0].el_text_color} ">${valj_efb[0].button_Previous_text}</span></button></div>
              `;break;case"logout":location.reload(),localStorage.clear()}document.getElementById("body_efb")&&document.getElementById("body_efb").scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}else document.getElementById("efb-final-step")?document.getElementById("efb-final-step").innerHTML=`<h3 class='efb emsFormBuilder'><i class="efb nmsgefb bi-exclamation-triangle-fill text-center efb fs-3"></i></h1><h3 class="efb  fs-3 text-muted">${ajax_object_efm.text.error}</h3> <span class="efb mb-2 efb fs-5"> ${res.data.m}</span>
    <div class="efb m-1"> <button id="prev_efb_send" type="button" class="efb btn efb ${valj_efb[0].hasOwnProperty("button_color")?valj_efb[0].button_color:"btn-darkb"}   ${valj_efb[0].hasOwnProperty("corner")?valj_efb[0].corner:"efb-square"}   ${valj_efb[0].hasOwnProperty("el_height")?valj_efb[0].el_height:"h-l-efb"}  p-2 text-center  btn-lg  " onClick="${btn_prev}"><i class="efb  ${valj_efb[0].button_Previous_icon} ${valj_efb[0].button_Previous_icon} ${valj_efb[0].icon_color} mx-2 fs-6 " id="button_group_Previous_icon"></i><span id="button_group_Previous_button_text" class="efb  ${valj_efb[0].el_text_color} ">${valj_efb[0].button_Previous_text}</span></button></div></div>`:alert_message_efb(res.data.m,"",14,"warning")}function response_Valid_tracker_efb(res){1==res.data.success?(document.getElementById("body_efb-track").innerHTML=emsFormBuilder_show_content_message(res.data.value,res.data.content),setTimeout(()=>{"function"==typeof reply_attach_efb&&reply_attach_efb(res.data.value.msg_id),state_rply_btn_efb(100)},50)):document.getElementById("body_efb-track").innerHTML=`<div class="efb text-center"><h3 class='efb emsFormBuilder mt-3'><i class="efb nmsgefb  bi-exclamation-triangle-fill text-center efb fs-1"></i></h1><h3 class="efb  fs-3 text-muted">${ajax_object_efm.text.error}</h3> <span class="efb mb-2 efb fs-5 mx-1">${ajax_object_efm.text.somethingWentWrongTryAgain} </br></br> ${res.data.m} </br></span>
     <div class="efb display-btn emsFormBuilder"> <button type="button" id="emsFormBuilder-text-prevBtn-view" class="efb  btn btn-darkb m-5 text-white" onClick="(() => {  location.reload(); })()" style="display;"><i class="efb ${1==ajax_object_efm.rtl?"bi-arrow-right":"bi-arrow-left"}"></i></button></div></div>`}function response_rMessage_id(res,message){var date;1==res.success&&1==res.data.success?(document.getElementById("replayM_emsFormBuilder").value="",document.getElementById("replay_state__emsFormBuilder").innerHTML=res.data.m,document.getElementById("replayB_emsFormBuilder").classList.remove("disabled"),document.getElementById("replayB_emsFormBuilder").innerHTML=ajax_object_efm.text.reply,document.getElementById("name_attach_efb")&&(document.getElementById("name_attach_efb").innerHTML=ajax_object_efm.text.file),date=Date(),fun_emsFormBuilder__add_a_response_to_messages(message,res.data.by,0,0,date),(message=document.getElementById("resp_efb")).scrollTop=message.scrollHeight):(document.getElementById("replayB_emsFormBuilder").innerHTML=ajax_object_efm.text.reply,document.getElementById("replay_state__emsFormBuilder").innerHTML=`<p class="efb text-danger bg-warning p-2">${res.data.m}</p>`)}function loadCaptcha_efb(){window.grecaptcha&&window.grecaptcha.render?(0!=valj_efb.length&&1==valj_efb[0].steps&&document.getElementById("btn_send_efb").classList.toggle("disabled"),grecaptcha.render("gRecaptcha",{sitekey:sitekye_emsFormBuilder})):setTimeout(()=>{this.loadCaptcha_efb()},500)}function calPLenEfb(len){let p=2;return p=len<=5?40:5<len&&len<=10?20:10<len&&len<=50?15:50<len&&len<=100?9:100<len&&len<=300?3:300<len&&len<=600?1.5:600<len&&len<=1e3?1.2:1.1}"object"==typeof ajax_object_efm&&ajax_object_efm.hasOwnProperty("ajax_value")&&"string"==typeof ajax_object_efm.ajax_value&&(g_timeout_efb=(g_timeout_efb,(ajax_object_efm.ajax_value.match(/id_/g)||[]).length),g_timeout_efb*=calPLenEfb(g_timeout_efb)),g_timeout_efb="object"==typeof ajax_object_efm&&"string"==typeof ajax_object_efm.ajax_value?g_timeout_efb:1100,setTimeout(()=>{var exportObj;jQuery(function(){var ajax_value,vs;"undefined"!=typeof ajax_object_efm&&(poster_emsFormBuilder=ajax_object_efm.poster,efb_var=ajax_object_efm,lan_name_emsFormBuilder=efb_var.language.slice(0,2),pro_efb="1"==ajax_object_efm.pro,page_state_efb="public",setting_emsFormBuilder=JSON.parse(ajax_object_efm.form_setting.replace(/[\\]/g,"")),"tracker"!=ajax_object_efm.state&&(ajax_value="string"==typeof ajax_object_efm.ajax_value?JSON.parse(ajax_object_efm.ajax_value.replace(/[\\]/g,"")):ajax_object_efm.ajax_value,ajax_object_efm.form_setting)&&0<ajax_object_efm.form_setting.length&&ajax_object_efm.form_setting!==ajax_object_efm.text.settingsNfound&&(form_type_emsFormBuilder=ajax_object_efm.type,vs=setting_emsFormBuilder,addons_emsFormBuilder=vs.addons,"userIsLogin"!=ajax_object_efm.type?sitekye_emsFormBuilder=1==ajax_value[0].captcha?vs.siteKey:"":form_type_emsFormBuilder=ajax_object_efm.type),"settingError"!==ajax_object_efm.state?"form"==ajax_object_efm.state?fun_render_view_efb(ajax_object_efm.ajax_value,1):"tracker"==ajax_object_efm.state?fun_tracking_show_emsFormBuilder():"settingError"==ajax_object_efm.state?fun_show_alert_setting_emsFormBuilder():"userIsLogin"==ajax_object_efm.state&&(document.getElementById("body_efb").innerHTML=show_user_profile_emsFormBuilder(ajax_object_efm.ajax_value)):fun_show_alert_setting_emsFormBuilder())}),exportObj={init:function(element,data,selectCb,options){createMultiselect(element,data,selectCb,options)}},motus_efb.ElementMultiselect=exportObj},g_timeout_efb),fun_text_forbiden_convert_efb=value=>value=(value=(value=(value=(value=(value=(value=(value=value.replaceAll("'","@efb@sq#")).replaceAll("`","@efb@vq#")).replaceAll('"',"@efb@dq#")).replaceAll(`	`," ")).replaceAll(``," ")).replaceAll("\r","@efb@nq#")).replaceAll(`
`,"@efb@nq#")).replaceAll("\r"," "),remove_ttmsg_efb=id=>{document.getElementById(id+"_-message")&&(document.getElementById(id+"_-message").classList.remove("show"),document.getElementById(id+"_-message").innerHTML="")},change_url_back_persia_pay_efb=()=>{var indx=document.URL.indexOf("?");-1!=indx&&history.pushState({page_id:1},document.title+" !",document.URL.slice(0,indx))},window.addEventListener("popstate",e=>{-1!=e.state.search("EFBstep-")&&(Number(e.state.slice(8))<=Number(current_s_efb)?prev_btn_efb():jQuery("#next_efb").trigger("click"))}),fun_gets_url_efb=()=>{var indx,getUrlparams=new URLSearchParams(location.search),iefb=getUrlparams.getAll("iefb"),hefb=getUrlparams.getAll("hefb"),sefb=getUrlparams.getAll("sefb"),defb=getUrlparams.getAll("defb"),vefb=getUrlparams.getAll("vefb");if(0<iefb.length)for(var i in iefb){const id=iefb[i],i_=valj_efb.findIndex(x=>x.id_==id);let i_p=-1,t_e="string";if(-1!=(i_p=1==valj_efb[i_].hasOwnProperty("parent")?valj_efb.findIndex(x=>x.id_==valj_efb[i_].parent):i_p)&&(t_e=1==(t_e=valj_efb[i_p].type.toLowerCase()).includes("select")&&0==t_e.includes("multi")||1==t_e.includes("radio")?"string":"array"),0<sefb.length&&sefb.length>i){if(-1==i_p)continue;"string"==t_e?1==sefb[i]&&(valj_efb[i_p].value=id):(indx="string"!=(t_e=typeof valj_efb[i_p].value)?valj_efb[i_p].value.findIndex(x=>x==id):-2,1==sefb[i]?-1==indx?valj_efb[i_p].value.push(id):-2==indx&&(valj_efb[i_p].value=[id]):-1<indx&&valj_efb[i_p].value.splice(indx,1))}0<defb.length&&defb.length>i&&(i_p=-1!=i_p?i_p:i_,1==defb[i]?valj_efb[i_p].disabled=1:0==defb[i]&&(valj_efb[i_p].disabled=0)),0<hefb.length&&hefb.length>i&&(i_p=-1!=i_p?i_p:i_,1==hefb[i]?valj_efb[i_p].hidden=1:0==hefb[i]&&(valj_efb[i_p].hidden=0)),0<vefb.length&&vefb.length>i&&-1==i_p&&(valj_efb[i].value=vefb[i])}},fun_booking_avilable=el=>{let r=[!0,""],id=el.id;"select"!=el.type&&"select-one"!=el.type||(id=el.options[el.selectedIndex].dataset.id);var row=valj_efb.find(x=>x.id_==id),lan=wp_lan.replaceAll("_","-"),lan=(new Date).toLocaleDateString(lan,{year:"numeric",month:"2-digit",day:"2-digit"});return uncheck=()=>{"radio"!=el.type&&"checkbox"!=el.type||(el.checked=!1)},"object"!=typeof row?(r=[!1,"Row not Found! contact to admin"],uncheck()):row.hasOwnProperty("dateExp")&&row.dateExp<lan?(r=[!1,"Sorry, the selected option is no longer available as its expiration date has passed. Please choose another option."],uncheck()):row.hasOwnProperty("mlen")&&Number(row.mlen)<=Number(row.registered_count)&&(r=[!1,"Unfortunately, the option you selected is no longer available. Please choose from the other available options."],uncheck()),r},post_api_forms_efb=data=>{var url=efb_var.rest_url+"Emsfb/v1/forms/message/add",headers=new Headers({"Content-Type":"application/json"}),data=JSON.stringify(data);fetch(url,{method:"POST",headers:headers,body:data}).then(response=>{if(response.ok)return response.json();throw new Error("Network response was not ok")}).then(responseData=>{response_fill_form_efb(responseData),localStorage.getItem("sendback")&&localStorage.removeItem("sendback")}).catch(error=>{console.log(error),response_fill_form_efb({success:!1,data:{success:!1,m:ajax_object_efm.text.eJQ500}})}),document.getElementById("prev_efb")&&0==document.getElementById("prev_efb").classList.contains("d-none")&&document.getElementById("prev_efb").classList.add("d-none"),document.getElementById("next_efb")&&0==document.getElementById("next_efb").classList.contains("d-none")&&document.getElementById("next_efb").classList.add("d-none")},post_api_tracker_check_efb=(data,innrBtn)=>{var url=efb_var.rest_url+"Emsfb/v1/forms/response/get",headers=new Headers({"Content-Type":"application/json"}),data=JSON.stringify(data);fetch(url,{method:"POST",headers:headers,body:data}).then(response=>{if(response.ok)return response.json();throw new Error(`Network response was not ok (HTTP ${response.status})`)}).then(responseData=>{document.getElementById("vaid_check_emsFormBuilder")&&(document.getElementById("vaid_check_emsFormBuilder").innerHTML=innrBtn,document.getElementById("vaid_check_emsFormBuilder").classList.toggle("disabled")),response_Valid_tracker_efb(responseData),efb_var.nonce_msg=responseData.data.nonce_msg,efb_var.msg_id=responseData.data.id}).catch(error=>{console.error(error.message),document.getElementById("vaid_check_emsFormBuilder")&&(document.getElementById("vaid_check_emsFormBuilder").innerHTML=innrBtn,document.getElementById("vaid_check_emsFormBuilder").classList.toggle("disabled")),response_Valid_tracker_efb({success:!1,data:{success:!1,m:error.message}})})},post_api_r_message_efb=(data,message)=>{var url=efb_var.rest_url+"Emsfb/v1/forms/response/add",headers=new Headers({"Content-Type":"application/json"}),data=JSON.stringify(data);fetch(url,{method:"POST",headers:headers,body:data}).then(response=>{if(response.ok)return response.json();throw new Error(`Network response was not ok (HTTP ${response.status})`)}).then(responseData=>{response_rMessage_id(responseData,message),sendBack_emsFormBuilder_pub=[]}).catch(error=>{console.error(error.message),response_Valid_tracker_efb({success:!1,data:{success:!1,m:error.message}})})};